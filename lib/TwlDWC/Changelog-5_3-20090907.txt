■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■

   Changelog for
   TwlDWC(_dl)-5_3-20090907-jp  (20090907 版)

■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■


■ TwlDWC(_dl)-5_3-20090907-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版][DL版]
・DWC初期化関数の仕様変更
　DWCの初期化関数DWC_Init()を、開発向けサーバ用のDWC_InitForDevelopment関数と、
　製品向けサーバ用のDWC_InitForProduction関数に分けました。またその引数で、
　DWCで使用するアロケータ及びGameSpy設定のgamename、アプリのイニシャルコードを
　指定するようになりました。これに伴い、
　 - DWC_SetAuthServer関数・DWC_SetMemFunc関数は廃止されました。
　 - DWC_CreateUserData関数の引数から、イニシャルコードを指定する変数が削除されました。
　 - 全てのサンプルデモが仕様変更に対応するため修正されました。
　 - DS-MRC及びTWLマスターエディタで認証サーバの判定が可能になりました。"DEBUG "の
     プレフィックスがついたDWCライブラリが表示されていた場合、最終ROMとして提出することは
     できません。
   - TWL-DWC プログラミングマニュアル　を修正しました。
   - TWL-DWC プログラミングマニュアル　ダウンロード編　を修正しました。
   - TWL-DWC プログラミングマニュアル　汎用ランキング編　を修正しました。

[通常版]
・友達無指定ピアマッチメイク開始時の不具合修正
　DWC_ConnectToAnybodyAsync関数内でDNS引きに失敗したとき、
　データアクセス例外を起こす問題を修正しました。

[通常版]
・マッチメイク締め切り処理の不具合修正
　DWC_RequestSuspendMatchAsync関数で開始した締切処理が終わらなくなることがあり、
　これを修正しました。

[通常版]
・DWC_GetCommonValueString関数の仕様変更
　引数valueにNULLを指定したとき、-1を返す仕様でしたが、keyに対応する文字列の
　長さを返すように変更しました。

[通常版][DL版]
・デモプログラムの修正
　- dwc_nd_sample
　  左右キーでDWC_NdSetAttrでセットする場所を変更する際、
　  配列の範囲を超えて書き込みを行うことがある問題を修正しました。
　- dwc_connect_inet_sample
　  DWC_TestInetProcess関数に失敗したときのデバッグメッセージが誤っており
　  これを修正しました。
　- dwc_frienddata_sample
　  update_inputFriendIndex関数の返り値の説明が誤っており、これを修正しました。
　- dwc_anybody_match_sample, dwc_eval_callback_sample, dwc_sc_match_sample
　  マッチメイクしたのちそのグループから抜けると、グループへの再接続のため、
　  "groupID reconnect"というメニューが表示されますが、このメニュー項目が
　  表示されなくなることがあり、これを修正しました。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
　ありません。


■ TwlDWC(_dl)-5_3_pr1-20090713-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版][DL版]
・CodeWarrior for NINTENDO DSi に対応
　CodeWarrior for NINTENDO DSi に対応しました。
　CodeWarrior for NINTENDO DS での動作保障はありません。

[通常版][DL版]
・WiFi設定ユーティリティの不具合修正
　終了時に、意図せずLCDへの出力がONの状態になってしまっておりましたので、
　OFFで終了するように修正しました。

[通常版]
・WiFiログイン時に20001エラーが発生する問題の修正
　DWC_LoginAsync関数によるWiFiログイン処理中に、意図せずエラーコード 20001 
　(DWC_GetLastError*関数で取得した時点で正の値) が発生することがあり、これを修正しました。

[通常版]
・サンプルデモの修正
　以下のサンプルデモで、グループIDによる再接続を行った際の内部ステート処理に
　不具合があり、これを修正しました。
　- dwc_anybody_match_sample
　- dwc_eval_callback_sample
　- dwc_friend_match_sample
　- dwc_sc_match_sample

[通常版][DL版]
・ニンテンドーゾーン シミュレーターに付属するドキュメントの修正
　tools/NZSimulator/readme.txt について、ニンテンドーゾーンが既にサービスイン
　している現在では不適切な記述がありましたので、これを修正しました。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
　ありません。


■ TwlDWC(_dl)-5_2-20090630-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版][DL版]
・TCP ソケットが RST を送信しない問題の修正
　TCP コネクションにおいて、RST を全く送信しておりませんでした。
　これを修正し、接続後の SYN、閉じたポートへの SYN など不適切なパケットに
　対して RST を返すようにしました。

[通常版][DL版]
・DWCの内部デバッグ出力関数の仕様変更
　レポート種別毎に付くヘッダ
　("DWC_INFO     :","++DWC_ERROR  :"など)を出力する関数を、
　OS_PutStringからOS_TPrintfに変更しました。

[通常版][DL版]
・デバッグプリントの誤字修正
　ライブラリ及びデモのデバッグプリントで successed となっていたところを
  succeeded に修正しました。

[通常版]
・マッチメイク機能の修正
　マッチメイク処理を最適化し、サーバへの負荷の軽減及びマッチメイク速度を若干向上させました。

[通常版]
・友達情報に変更があった場合でも、DWCBuddyFriendCallback関数が呼ばれない問題の修正
　ある友達を削除して片思いの友達の状態にし、DWC_UpdateServersAsync関数を呼んで
　お互いからDWC_IsBuddyFriendData関数がFalseを返すことが確認された後、
　友達を削除した側で同じ友達を再登録したときに、再登録される側がオンライン状態であった場合、
　再登録される側でDWC_IsBuddyFriendData関数がTrueを返す状態に変化しても
　DWCBuddyFriendCallback関数が呼ばれない問題を修正しました。

[通常版]
・サンプルデモの修正
　以下のサンプルデモで、DWC_ETYPE_LIGHT エラーが発生した場合、
　表示画面が正しく更新されない問題を修正しました。
　- dwc_eval_callback_sample
　- dwc_friend_match_sample
　- dwc_frienddata_sample
　- dwc_sc_match_sample

[通常版][DL版]
・TWL-DWC プログラミングマニュアル　ダウンロード編　の修正
　「3.3.2 任天堂認証サーバへログインする」で
　DWC_NASLoginProces関数の戻り値の表記が誤っていたため修正しました。

[通常版]
・TWL-DWC プログラミングマニュアル　の修正
　- 「8.1 ピア・ツー・ピアのデータ送受信」に、
　   デバッグ出力によりパケットが遅延して見えることがある旨を追記しました。
　- 「8.4 DWC_InitFriendsMatch関数で指定するバッファサイズの目安」で
　   Reliable通信におけるバッファサイズの目安の計算式が誤っていたので修正しました。
　※DL版にも本マニュアルは付属しますが、今回の変更内容は通常版にのみ関係します。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
　ありません。


■ TwlDWC(_dl)-5_2_pr1-20090430-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版]
・DWC_RnkShutdown関数の仕様変更
　既にランキングライブラリが本関数によって終了されている時に呼ばれた場合
　ASSERTしておりましたが、何もせず返るように変更しました。

[通常版]
・DWCRnkRegion型の修正
　DWCRnkRegion型のDWC_RNK_REGION_CH（中国）をDWC_RNK_REGION_CNに修正。
　旧定義も残されています。 

[通常版]
・汎用ランキング管理ツールの修正
　- 入力コントロールを空にすると管理ツールが異常終了する問題を修正。
　- サーバのランキングデータをファイルにダウンロードする際に指定する日付が
　　正しく反映されない問題を修正。
　- サーバのランキングデータを取得する機能の名称を実態に合わせて"Get CSV"
　　から"Get TSV"に修正。

[通常版][DL版]
・TWL-DWC プログラミングマニュアル　の修正
　「5.1 インターネットに接続する」で、文末の誤植を修正しました。

[通常版]
・TWL-DWC プログラミングマニュアル 汎用ランキング編　の修正
　- 汎用ランキング管理ツールの更新に対応しました。
　- 中国リージョンに関する記載を追加。
　- 汎用ランキング管理ツールの"Get TSV"で取得できるファイルのフォーマット
　　の説明にリージョンが含まれていなかった誤記を修正。
　- Webサービスで取得できるファイルの形式がCSVとなっていた誤記を修正。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
　ありません。


■ TwlDWC(_dl)-5_1_patch1-20090402-jp で修正・変更された内容
----------------------------------------------------------------------------

[通常版][DL版]
・サンプルデモの修正
　- 非公開関数PXI_Init*を呼ばないように修正しました。
　- DWC_Init関数から呼ばれるRTC_Init,OS_InitTick,OS_InitAlarm関数について、
　　サンプル内で重複して呼んでいた部分を削除しました。
　- ダウンロードライブラリのサンプルデモのreadme.txtの記述で、実際にサーバに
　　登録されている情報と異なっていた部分を修正しました。

[通常版][DL版]
・Wi-Fiコネクション設定でＬＣＤオフ復帰で下画面が白くなる問題の修正
　Wi-Fiコネクション設定起動中に端末の蓋を開閉すると、下画面が白いまま、画面が復帰しない問題があり、
　これを修正しました。

[通常版][DL版]
・自動接続処理のSSL通信に関する修正
　本体にまだ認証済みのユーザIDがない場合など、自動接続処理において認証サーバとの
　通信が発生するケースで、伝搬路状況が悪いと、自動接続処理処理中まれに、DEBUGビルドでは
　os_thread.cでPanic、RELEASE,FINALROMビルドでは無限ループに陥る問題があり、これを修正しました。

[通常版][DL版]
・TWL-DWC プログラミングマニュアル　の修正
　用語統一のため、「プロファイルID」と書かれていた部分を
　「GSプロファイルID」に修正しました。

[通常版][DL版]
・Changelogの記述漏れを修正
　ランキングステートがエラーになっても エラーコードが 0 になる場合がある問題の修正が、
　TwlDWC5.1PR1にて行われましたが、Changelogに記載されておりませんでしたので、追記しました。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
　ありません。


■ TwlDWC(_dl)-5_1-20090311-jp で修正・変更された内容
----------------------------------------------------------------------------

[通常版][DL版]
・NITRO ROM に対応
　NITRO ROM のビルドに対応しました。

[通常版][DL版]
・TWL-WIFI3.1正式版を統合
　TWL-WIFI3.1正式版を統合しました。今後もTWL-WIFIはDWCに含まれる形でリリースされます。
　具体的には以下のファイルが追加されています。
　 - lib/ 以下の各WiFiライブラリ (cps,ncfg,nhttp,soc,ssl,stubsssl,wcm)
　 - build/buildtools/commondefs.WiFi
　 - build/buildtools/modulerules.WiFi
　※TWL-DWCのビルドシステムでは、内部的に環境変数 TWLWIFI_ROOT を使用していて、
　　デフォルトで TWLWIFI_ROOT はTWLDWC_ROOT を指します。通常の開発では、
　　デフォルトのままご利用下さい。既に TWLWIFI_ROOT が設定されていた場合、
　　そちらのパスを使用するようになりますので、設定されている環境変数 TWLWIFI_ROOT を
　　リネームもしくは削除して下さい。

[通常版][DL版]
・DWC_SetRwinSize関数の仕様変更
　互換性等を考慮し、本関数はTWLモードでのみ有効な関数となりました。

[通常版][DL版]
・ログイン処理の修正
　認証サーバとの通信で、リトライする必要の無いエラーが発生した場合でも
　リトライしてしまっていた問題を修正しました。

[通常版][DL版]
・DWC_Init関数の修正
　RTC_Init関数をDWC_Init関数内で呼ぶように修正しました。
　前バージョンまでの関数リファレンスには、DWC_Init関数を呼ぶ前に呼んでおく必要がある関数として、
　RTC_Init関数の他に、OS_Init関数、OS_InitTick関数、OS_InitAlarm関数が
　記載されておりましたが、OS_InitTick関数とOS_InitAlarm関数については、既にDWC_Init関数
　内で呼ばれており、リファレンスが誤っておりました。今回の修正で、アプリがDWC_Init関数
　より前に呼ばなければいけない関数は、OS_Init関数のみになります。

[通常版]
・DWC_SetSendDrop/DWC_SetRecvDrop関数の修正
　本関数を何度も呼んだ時、スタックオーバーフローする問題を修正しました。

[通常版]
・DWC_SetSendDelay/DWC_SetRecvDelay関数の修正
　3人以上のマッチメイクにおいて、DWC_SetSendDelay/DWC_SetRecvDelay関数による
　遅延設定をした状態でマッチメイクグループの誰かが抜けると、残ったクライアントで
　データアクセス例外が発生することがある問題を修正しました。

[通常版]
・マッチメイクライブラリの修正
　TwlDWC5_1_pr1で修正された、
　"フレンドが存在するグループに一度接続した後LAN ケーブルを抜くなどして切断し、
　そのグループがその切断を検知する前に再接続しようとすると、
　マッチメイクが正常に進行しなくなる不具合" について、ASSERTで止まる不備があり、
　再修正しました。

[通常版][DL版]
・デモプログラムの修正
　デモプログラムに廃止されたFram用の関数が残っていた問題を修正しました。

[通常版][DL版]
・独自ゲームサーバ利用説明書の修正
　詳細はドキュメントの変更履歴を参照下さい。

[通常版][DL版]
・TWL-DWC プログラミングマニュアル　ダウンロード編　の修正
　「5.2.2 管理メニュー」で、正しくリンクが張られていない問題を修正しました。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
　ありません。


■ TwlDWC(_dl)-5_1_pr2-20090204-jp で修正・変更された内容
----------------------------------------------------------------------------

[通常版][DL版]
・buildtoolsの修正
　ダウンロードライブラリで使用するTwlWiFiのnhttpライブラリを、
　DWCのcommondefs.dwcでリンクするように修正しました。

[通常版][DL版]
・HYBRID ROMをDSで動かした時のMTU値の変更
　1400バイトから576バイトに変更しました。

[通常版][DL版]
・ダウンロードライブラリの修正
　ダウンロードライブラリの任意の非同期処理が終了してから、次の非同期処理関数を呼ぶ
　までの間隔が、およそ2-3Vblank以下であったとき、31010エラーが発生することがある
　問題を修正しました。

[通常版][DL版]
・DWC_SVLGetTokenAsync関数で取得したサービスロケータ情報のチェックを見直し
　DWC_SVLGetTokenAsync関数を使って認証サーバから取得したサービスロケータ情報について、
　ライブラリが正しくデコードできなかった場合は、エラーを返すようにしました。
　認証サーバが正しく動作している限りは、これが問題になることはありません。

[通常版]
・Wi-Fiログイン時にメモリリークすることがある問題の修正
　1度ログインしたのち、セーブデータなどから、ユーザーデータを1度もログイン
　したことが無い状態に戻して再ログインしたとき、メモリリークする問題を修正しました。

[通常版]
・DWC_FRIEND_STATUS_STRING_LENの修正
　DWC_FRIEND_STATUS_STRING_LENが255と定義されていたので256に修正しました。

[通常版]
・まだ誰とも接続していない状態でのAID、接続ホスト数取得に関する修正
　まだ誰とも接続していない状態ではDWC_GetMyAID関数、DWC_GetNumConnectionHost関数、
　DWC_GetAIDBitmap関数、DWC_GetAIDList関数を使用できませんでしたが、
　それぞれまだ誰とも接続していない旨を表す値を返すように修正しました。
　(各関数が返す値の詳細については関数リファレンスを参照してください)

[通常版]
・デモプログラムの修正
　FRAMをバックアップデバイスとして選択可能になっていた部分を、
　選択できないように修正しました。

[通常版][DL版]
・TWL-DWC プログラミングマニュアル　ダウンロード編　の修正
　- 管理サイトへアクセスできるIPを、制限できるようになったことに対応しました。

[通常版]
・TWL-DWC プログラミングマニュアルの修正
　-「7.7 ConnectAttemptCallback」と「7.8 サーバ交代」に
　  サーバクライアントマッチメイクではサーバ交代が発生しない旨を追記しました。
　-「コード7-8 ConnectAttemptCallbackの例」をDWC_GetAIDList関数の仕様変更に合わせて修正しました。

[通常版][DL版]
・関数リファレンスの修正
　・分類変更
　　- 初期化、エラー関係、メモリ割り当て、Base64変換、デバッグ出力に関する項目を
　　 「共通・ユーティリティ」に分類しました。
　　- Wi-Fiコネクション接続処理、サービスロケータに関する項目を、「認証サーバー」
　　  に分類しました。
　　-「アカウント処理」という分類名を「アカウント」に変更しました。
　　-「インターネット接続処理」という分類名を「インターネット接続処理」に変更しました。
　　-「友達管理・マッチメイク処理」という分類名を「友達管理・マッチメイク」に変更しました。
　・以下の旧仕様の関数が削除されました。
　　- DWC_CloseConnectionsBitmapFromServer
　　- DWC_CloseConnectionsAsync
　　- DWC_LoadOwnDataAsync
　その他の変更についてはリファンスの変更履歴を参照下さい。

★既知の不具合など
[通常版][DL版]
・NITRO ROM 対応
　2月下旬リリース予定のバージョンで対応します。
[通常版]
・ランキングライブラリの利用について
　ランキングを使用するタイトルは、TWL-DWC5.1以降を使用して下さい。
　マスター提出可能な5.1系のDWCは、2月の下旬にリリースする予定です。


■ TwlDWC(_dl)-5_1_pr1-20081226-jp で修正・変更された内容
----------------------------------------------------------------------------

[通常版][DL版]
・自動接続処理の修正
　自動接続処理中にFatalエラーが発生すると、DWC_CleanupInetAsync関数が即Falseを返す
　仕様になっておりましたが、Trueを返すように修正しました。

[通常版][DL版]
・無線接続中の致命的なエラーに関する修正
　無線接続中に下位レイヤで起きた復帰不可能なエラーについて、DWCがFatalエラーをセット
　しない問題を修正しました。

[通常版][DL版]
・DWC_SetRwinSize関数に制限値を追加
　4288バイト〜65535バイトの範囲でのみ設定が可能なように修正しました。

[通常版][DL版]
・ビルドツールcommondefs.dwcの修正
　libdwcnonportがcommondefs.dwcでライブラリファイルに含められていなかった問題を
　修正しました。

[通常版][DL版]
・ライブラリファイルの追加及び削除
　以下の通り、ライブラリファイルが追加・削除されました。

　・通常版とDL版に追加されたライブラリ
　  - libdwccommon
　  - libdwcnas

　・通常版とDL版から削除されたライブラリ
　  - libdwcbase  (libdwcacに統合されました。)

　・通常版にのみ追加されたライブラリ
　  - libdwcenc
　  - libdwcghttp
　  - libdwcmatch

　・DL版からのみ削除されたライブラリ
　  - libdwcaccount

[通常版]
・DWC_ProcessFriendsMatch関数の修正
　アクセスポイントとの接続確認(DWC_UpdateConnection関数と同等の処理)が、
　機能していない問題を修正しました。

[通常版]
・マッチメイクライブラリの修正
　フレンドが存在するグループに一度接続した後LAN ケーブルを抜くなどして切断し、
　そのグループがその切断を検知する前に再接続しようとすると、
　マッチメイクが正常に進行しなくなる不具合を修正しました。

[通常版]
・エラーコード80430の細分化
　従来80430(DWC_ECODE_TYPE_SC_CL_FAIL)として発生していた要因のうち、
　サーバ交代失敗については　 80431(DWC_ECODE_TYPE_FAILED_SERVER_MIGRATION)　を、
　GroupID接続失敗については　80432(DWC_ECODE_TYPE_FAILED_CONNECT_GROUPID)　を、
　それぞれ割り振りました

[通常版]
・ランキングライブラリの修正
　- 下りデータに対するセキュリティ耐性の向上
　  TwlDWCでランキングを使用するタイトルは、必ず5.1以降のDWCを利用して下さい。
　- DWCRnkGetParam構造体のメンバ near が、nearby に名前変更されました。
　- ランキングステートがエラーになっても エラーコードが 0 になる場合がある問題を修正
　　サーバが受信したデータの正当性のチェックに失敗した場合や、クライアント（ アプリケーション ）
　　が受信したデータの正当性のチェックに失敗した場合に、汎用ランキングライブラリでステートが
　　エラーになっても、DWC_GetLastError* 関数で取得されるエラーがセットされない問題を修正しました。

[通常版]
・GHTTPライブラリの非公開化
　GHTTPライブラリが非公開になり、該当するデモを削除しました。
　ドキュメントで関連する項目も削除してあります。

[通常版]
・TWL-DWC プログラミングマニュアルの修正
　「7.8 サーバ交代」 　の誤植を修正しました。

[通常版]
・TWL-DWC プログラミングマニュアル　汎用ランキング編　の修正
　友達ランキング取得モードでは最大65個のデータを取得できる旨 を追記しました。

[通常版][DL版]
・TWL-DWC プログラミングマニュアル　ダウンロード編　の修正
　コード 4-4 キャンセル処理で、DWC_NdCancelAsync関数を呼んだ後に、
　DWC_NdProcess関数が呼ばれるようにコードを修正しました。

[通常版]
・DWC_CloseConnectionHardBitmapFromServer関数の追加
　DWC_CloseConnectionsBitmapFromServer関数が廃止になり、代りに、名前違いで同仕様の
　DWC_CloseConnectionHardBitmapFromServer関数が追加されました。
　DWC_CloseConnectionsBitmapFromServerは内部でDWC_CloseConnectionHardBitmapFromServer
　に#defineで置換されます。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。


■ TwlDWC(_dl)-5_0_patch2-20081215-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版][DL版]
・ログイン時に発生するエラーコードの修正
　本来発生すべきエラーが、20901エラーで上書かれてしまっていた問題を修正しました。
　※20901エラーは発生しなくなりました。

[通常版][DL版]
・DWC_SetRwinSize関数の修正
　DWC_InitInet*関数を呼ぶ前に、DWC_SetRwinSize関数を呼ぶと、1桁のエラーコード
　がセットされてしまう問題があり、修正しました。

[通常版][DL版]
・Wi-Fiコネクション設定の修正
　割り込みを禁止した状態で終了することを想定しているにも関わらず、
　割り込みを許可した状態になっていた問題を修正しました。

[通常版]
・マッチメイクライブラリの修正
　サーバクライアント型のマッチメイクで、特定のタイミングでクライアントが、
　マッチメイクをキャンセルすると、メモリリークする問題を修正しました。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版]
・ランキングライブラリのセキュリティ強化
　サーバからダウンロードしたデータに対して、
　ライブラリ内部で改竄を検出する機能を追加する予定です。


■ TwlDWC(_dl)-5_0_patch1-20081125-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版][DL版]
・ダウンロードライブラリの修正
　ユーザがファイルリスト取得後に、管理者がダウンロードサーバ上のファイルに対して
　同じファイル名のままサイズを大きくする更新をし、さらにその後ユーザが
　そのファイルをダウンロードしたときにFATALエラーがセットされる仕様になって
　おりましたが、復帰可能なエラーをセットするように変更しました。
　エラーコード31040、エラータイプDWC_ETYPE_SHUTDOWN_ND がセットされます。

[通常版][DL版]
・Wi-Fiコネクション設定の修正
　Wi-Fiコネクション設定で、サウンドがおかしくなる問題を修正しました。

[通常版][DL版]
・デモプログラムの修正
　- バックアップデバイスを指定するデモプログラムにおいて、4Mbit Flashの定義を追加しました。
　- 本番の認証サーバを使用するように指定していた部分を、デフォルトでは指定しないように
　　修正しました。
　- dwc_anybody_match_sample では、起動直後にマッチメイクを自動開始するように
　　なっていましたが、ボタン操作で開始するように修正しました。
　- dwc_nd_sample で、受信ウィンドウサイズを設定するように修正しました。

[通常版]
・マッチメイクライブラリの修正
　フレンドマッチにおいて、マッチメイク開始タイミングによって
　マッチメイク処理が進まなくなることがある問題を修正しました。

[通常版]
・データ送受信関係のデバッグ関数を修正
　以下の関数の返りの型が、FINALROMビルドでBOOL型からvoid型になっていましたが、
　FINALROMビルドでもBOOL型となるように修正しました。
　- DWC_SetRecvDelay()
　- DWC_SetRecvDrop()
　- DWC_SetSendDelay()
　- DWC_SetSendDrop()

[通常版]
・サーバクライアントマッチメイクの修正
　サーバクライアントマッチメイクで、誰か一人でもグループから抜けると
　そのグループに誰も参加できなくなるバグを修正しました。
　(サーバホストが抜けた場合そのグループに参加できなくなるのは仕様です。)

[通常版]
・Changelogの誤記修正
　TwlDWC(_dl)-5_0-20081104-jpの修正内容で、
　- DWCLoadFromServerCallbackの仕様を変更
　　DWC_SavePrivateDataAsync関数でセーブしたキーを読もうとした場合は
　　successがTRUE、dataが""(空文字列)、lenが0になります。
　とありましたが、正しくは下記の通りです。
　- DWCLoadFromServerCallbackの仕様を変更
　　DWC_SavePrivateDataAsync関数でセーブしたキーを読もうとした場合と
　　キーが存在しなかった場合は
　　successがTRUE、dataが""(空文字列)、lenが0になります。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
[通常版]
・ランキングライブラリのセキュリティ強化
　サーバからダウンロードしたデータに対して、
　ライブラリ内部で改竄を検出する機能を追加する予定です。
　12月上旬のリリースを予定しています。


■ TwlDWC(_dl)-5_0-20081104-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版][DL版]
・ダウンロードライブラリを追加しました。NitroDWCに実装されていたものから、
　以下の点が変更になっている点に注意して下さい。詳しくは、関数リファレンス
　を参照下さい。

　- httpスタックの変更
　　DWC独自のhttpではなく、TwlWiFiのNHTTPライブラリを使用するようになりました。

　- ライブラリのインクルードパスの変更
　　ライブラリのインクルードパスを、<nd/dwc_nd.h> から、<dwc.h> へ
　　変更しました。

　- DWC_NdProcess関数の追加
　　ダウンロードライブラリの処理を進めるDWC_NdProcess関数を追加しました。
　　毎ゲームフレーム程度の頻度で呼ぶ必要があります。

　- DWC_NdCleanupAsync関数の仕様変更
　　引数にとっていたコールバックを廃止しました。処理の完了は、
　　DWC_NdInitAsync関数で指定したコールバックの DWCNdCallbackReason型のreason
　　によって知ることができます。

　- DWC_GetLastError*関数で取得できるエラーを追加
　　DWC_ECODE_TYPE_ND_BUSY(-10)、DWC_ECODE_TYPE_ND_PARAM(-40)を追加しました。

　- ダウンロード機能のプログラミングマニュアルを修正
　　/docs/Nintendo_WiFi_Connection_TWL-DWC_ProgrammingManual_Download.pdf
　　を修正しました。

[通常版][DL版]
・Proxy設定ありの接続先の場合、DWC_TestInetAsync関数が必ず失敗する問題を修正
　Proxy設定がされた接続先に接続した場合、本関数は1回目の呼び出しの時、
　接続先ドメインの名前解決のため長時間ブロックする可能性がありますので
　注意して下さい。2回目以降は、staticな領域に保存されたIPアドレスを使用します
　ので長時間ブロックすることはありません。 

[通常版][DL版]
・Wi-Fiログイン時にWi-FiConnectionIDを生成するシーケンスを追加
　Proxy設定されている接続先の場合、自動接続でWi-FiConnectionIDが
　生成されないので、DWC_LoginAsync(),DWC_NASLoginAsync()でのWi-Fiログイン試行時に、
　生成を試みるシーケンスを追加しました。このシーケンスでもなお、
　ID生成用のサーバと接続できない場合は、20901エラーがセットされます。

[通常版][DL版]
・ニンテンドーゾーン接続時にIRQスタックを大量に消費する問題を修正
　IRQスタックを約1kB消費する実装になっておりましたが、
　このワークメモリをアプリケーションが DWC に指定したアロケータを使って、
　確保するように修正しました。

[通常版][DL版]
・ニンテンドーゾーンでの接続をテストするツールを追加
　/tools/NZSimulator 以下を参照下さい。

[通常版][DL版]
・独自ゲームサーバ利用説明書を追加
　開発者が独自に用意したゲームサーバを利用するための説明書を、
　/docs/Nintendo_WiFi_Connection_IndependentServerManual 以下に追加しました。

[通常版][DL版]
・Wi-Fiコネクション設定の修正
　FINALROMビルドの場合、DWC_SetAuthServer関数の指定に関わらず製品向けサーバ
　を使用するように仕様変更しました。

[通常版][DL版]
・DWC_UpdateConnection関数の仕様変更
　DWC_UpdateConnection関数では、APとの切断(DCFの切断)を検出すると、
　内部でDWC_CleanupInet関数を呼んで、ソケットを閉じていましたが、
　ソケットを閉じないように仕様変更しました。

[通常版]
・DWCLoadFromServerCallbackの仕様変更
　DWC_SavePrivateDataAsync関数でセーブしたキーを読もうとした場合は
　successがTRUE、dataが""(空文字列)、lenが0になります。

[通常版]
・DWC_UpdateServersAsync関数の内部処理を修正
　DWC_UpdateServersAsync関数の友達情報の整理を行う処理で、友達リストに
　ログインID(DWC_FRIENDDATA_LOGIN_ID)、フレンドキー(DWC_FRIENDDATA_FRIEND_KEY)の
　順番に入っている場合は、整理/削除され、逆の順番の場合は、整理/削除されない
　という統一されない動作になっていました。
　同じログインIDのGSプロファイルIDは複数存在する可能性があることから、
　統一して、いずれの場合も削除しないように修正しました。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。

★既知の不具合など
　ありません。


■ NitroDWC(-dl)-3_1-plus3-080909 -> TwlDWC(_dl)-5_0_rc1-20081014-jp
   で修正・変更された内容
----------------------------------------------------------------------------
[通常版]
・マッチメイク機能が大幅に変更になりました。
　NitroDWCに実装されていたものとの互換性はありません。
　詳しくは、/docs/Nintendo_WiFi_Connection_TWL-DWC_ProgrammingManual.pdf
　を参照下さい。

[通常版][DL版]
・rwinサイズを指定する関数を追加
　rwinサイズを指定する DWC_SetRwinSize() 関数を追加しました。

[通常版][DL版]
・Proxy設定を取得する関数を追加
　Proxy設定を取得する DWC_GetProxySetting() 関数を追加しました。

[通常版]
・SHA1*、MD5*のシンボル名を変更
　他ライブラリとの衝突を避けるため、GamespySDKに含まれるSHA1*、MD5*の
　シンボル名をGS_SHA1*、GS_MD5*に変更しました。

[通常版][DL版]
・EULAのバージョンチェックを実装
　インターネットへの自動接続時に、ライブラリでEULAのバージョンと
　同意しているかをチェックするようにしました。
　EULAへの同意が必要と判断された場合は、エラーコード -50599 がセットされ、
　自動接続が終了します。
　※アプリが要求するEULAのバージョンを、ROMヘッダで必ず指定して下さい。

[通常版][DL版]
・設定ユーティリティの修正
　DWC_StartUtility関数のparamの引数チェックに、北米向けのサポート電話番号が
　表示されるオプションが指定されていた場合は、FALSEを返すように条件を追加。

[通常版][DL版]
・自動接続中にDWC_CleanupInet*()を呼んだときに起こる可能性がある問題を修正
　- DWC_CleanupInet*()が終了しなくなることがある問題を修正
　- DWC_CleanupInet*()を呼んだとき、無線がONになりっぱなしになることがある
　　問題を修正。

[通常版][DL版]
・自動接続でFatalエラーが発生すると、DWC_CheckInet()がTrueを返さなくなる問題を修正

[通常版][DL版]
・無線切断によって、ネットワークから切断された後に、
　DWC_LoginToStorageServerAsync関数を呼び出すと、ハングアップしてしまう問題を修正。

[通常版]
・デモプログラムの修正
　マッチメイク指標キーをマッチメイク開始前に呼び出すように変更しました。

[通常版][DL版]
・デモプログラムで、libdwcutil.a がオーバーレイしない不具合を修正。

[通常版][DL版]
・関数リファレンスが修正されました。
　詳しくは、関数リファレンスの変更履歴を参照下さい。

[通常版]
・GameSpy SDKのassertに関する修正
Debug/Release/Romの全てのビルドでassertが有効になっていてコードサイズに
影響を与えていた問題を修正。（Debugのみ有効なように修正）

[通常版][DL版]
・不正文字列チェックの修正
　- 不正文字列チェックで全リージョンを対象にした場合に、
　　ライブラリ未定義のリージョンのみで不正と判断されたら、
　　日本リージョンのみが不正という結果になってしまう問題を修正。
　- デモプログラムを全リージョンチェックに対応
　- 中国リージョンに対応

★既知の不具合など
・ダウンロード機能がTwl対応されていません(未実装)


■ 5_0pr8-081001 -> 5_0_rc1-20081011-jp で修正・変更された内容
----------------------------------------------------------------------------
[通常版]
・以下の機能を追加
　- 友達管理・マッチメイク処理
　- HTTP通信
　- 汎用ランキング
※マッチメイク処理は、NitroDWCに実装されていたものから大幅に変更になり、
互換性がなくなりました。詳しくは、
/docs/Nintendo_WiFi_Connection_TWL-DWC_ProgrammingManual.pdf
を参照下さい。

[通常版][DL版]
・以下の機能を追加
　- Wi-Fiコネクション接続処理 (DWC_NASLogin*)
　- サービスロケータ処理 (独自サーバ対応)
　- 不正文字列チェック
※ダウンロード機能は未実装です。

[通常版][DL版]
・関数リファレンスの修正
　詳しくは、関数リファレンスの変更履歴を参照下さい。
