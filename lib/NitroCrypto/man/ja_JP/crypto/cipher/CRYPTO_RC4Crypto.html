<!--DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"-->
<!--==========================================================================
  Project:  NitroCrypto - man
  File:     CRYPTO_RC4Crypto.html

  Copyright 2005,2006 Nintendo.  All rights reserved.

  These coded instructions, statements, and computer programs contain
  proprietary information of Nintendo of America Inc. and/or Nintendo
  Company Ltd., and are protected by Federal copyright law.  They may
  not be disclosed to third parties or copied or duplicated in any form,
  in whole or in part, without the prior written consent of Nintendo.

  $Log: CRYPTO_RC4Crypto.html,v $
  Revision 1.6  2006/03/01 00:34:02  okubata_ryoma
  ｃｓｓの位置移動

  Revision 1.5  2006/02/24 02:43:08  okubata_ryoma
  履歴の追加

  Revision 1.4  2006/02/24 01:47:47  okubata_ryoma
  NitroCrypto の新設　Crypt から Crypto へ

  Revision 1.3  2006/01/30 04:30:06  seiki_masashi
  説明を追記

  Revision 1.2  2005/12/28 00:44:46  seiki_masashi
  誤記の修正

  Revision 1.1  2005/12/27 12:42:16  seiki_masashi
  RC4 関数の追加

  $NoKeywords: $
 ==========================================================================-->
<HTML>
	<HEAD>
		<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
		<META http-equiv="Content-Style-Type" content="text/css">
		<TITLE>CRYPTO_RC4Crypto</TITLE>
		<LINK rel="stylesheet" href="../../css/nitro.css">
		<BASE target="main">
	</HEAD>
	<BODY>
		<H1>CRYPTO_RC4Crypto</H1>

		<H2>構文</H2>
		<DL>
			<DD>
				<PRE><CODE>
#include &lt;nitroCrypto/crypto/rc4.h&gt;

void CRYPTO_RC4Crypto(
    CRYPTORC4Context* context,
    const void* in,
    u32 length,
    void* out,
);

void CRYPTO_RC4FastCrypto(
    CRYPTORC4FastContext* context,
    const void* in,
    u32 length,
    void* out,
);
				</CODE></PRE>
			</DD>
		</DL>

		<H2>引数</H2>
		<TABLE border="1">
			<TBODY>
				<TR>
					<TD width="25%"><EM><STRONG><CODE>context</CODE></STRONG></EM></TD>
					<TD width="75%">CRYPTO_RC4Crypto 関数では <A href="CRYPTO_RC4Init.html">CRYPTO_RC4Init</A>関数で予め鍵を設定した CRYPTORC4Context 型の構造体を指定します。<BR>
					CRYPTO_RC4FastCrypto 関数では <A href="CRYPTO_RC4Init.html">CRYPTO_RC4FastInit</A>関数で予め鍵を設定した CRYPTORC4FastContext 型の構造体を指定します。</TD>
				</TR>
				<TR>
					<TD><EM><STRONG><CODE>in</CODE></STRONG></EM></TD>
					<TD>RC4 アルゴリズムによる暗号化/復号を行う対象のデータへのポインタを指定します。</TD>
				</TR>
				<TR>
					<TD><EM><STRONG><CODE>length</CODE></STRONG></EM></TD>
					<TD>in で指定したデータの長さを指定します。</TD>
				</TR>
				<TR>
					<TD><EM><STRONG><CODE>out</CODE></STRONG></EM></TD>
					<TD>暗号化/復号を行った結果を格納する先のポインタを指定します。</TD>
				</TR>
			</TBODY>
		</TABLE>

		<H2>返り値</H2>
		<P>
			ありません。
		</P>

		<H2>説明</H2>
		<P>
			共通鍵暗号である RC4 アルゴリズムによる暗号化/復号を行います。RC4 アルゴリズムは暗号化と復号を同一の関数で行います。
			in に格納されているデータに対して処理を行い、変換結果を out に出力します。in と out に同じポインタを指定して上書きすることも可能です。
		</P>
		<P>
			CRYPTO_RC4* 関数と CRYPTO_RC4Fast* 関数の違いは使用するメモリ量と処理速度です。
			CRYPTO_RC4* 関数で使用する CRYPTORC4Context 構造体は 260 バイトですが、
			CRYPTO_RC4Fast* 関数で使用する CRYPTORC4FastContext 構造体は 1032 バイトを使用します。
			また、十分大きなサイズのデータを扱う場合、CRYPTO_RC4FastCrypto 関数のほうが1.5倍程度速く処理を行います。
			ただし、速度差が出るのは in と out に同じポインタを与えた場合であり、異なるポインタを与えた場合は
			CRYPTO_RC4Crypto 関数と CRYPTO_RC4FastCrypto 関数であまり速度に違いはでません。
		</P>
		<P>
			この関数は、ゲーム中に動的に生成されたデータを平文のままネットワークに流したくない場合や、
			バックアップに平文のまま保管したくない場合などに、手軽に暗号化を行えるように用意されています。
			RC4 アルゴリズムは鍵が未知の場合の効果的な解析方法が発見されておらず、なおかつ暗号・復号化処理が高速なのが特徴です。
			ただし、共通鍵暗号ですので、基本的にはソフト内に暗号・復号双方で用いる鍵データを保管しておく必要があります。
			そのため、ROM バイナリの解析によって鍵が明らかになり、暗号が危殆化される可能性があります。
			<span style="color: red;">この関数を共通鍵暗号として単純に用いて、機密度の高いデータの暗号化や、データの出自の認証を行うことは避けてください。</span>
			なお、データの認証をしたい場合は、<CODE><A href="../sign/CRYPTO_VerifySignature.html">CRYPTO_VerifySignature</A></CODE> 関数による電子署名の認証機能が利用可能です。
			また、サーバと安全に通信を行いたい場合は SSL 通信を利用してください。
		</P>
		<P>
			RC4 アルゴリズムの基本的な動作は、鍵から一意に決定される乱数列を作成し、元データと XOR を取る、というものです。
			そのため、同一の鍵からは常に同じ暗号用の乱数列が生成されることに注意が必要です。
			これは以下を意味します。(1) 同じ鍵・同じデータからは常に同じ暗号データが生成される。
			(2) 同じ鍵から作成された2つの暗号データの XOR を取ると、それぞれの平文を XOR したものを取得することができる。<BR>
			これらを避けるためには、毎回異なる Initialization Vector (IV) と呼ばれる乱数を用意し、
			共通鍵に IV を加えたものを実際の鍵として RC4 アルゴリズムを適用する必要があります。
			暗号データを送信する際には、一緒に IV も（暗号化せずに）送るようにします。
			詳細は、一般的な暗号の書籍を参照してください。
		</P>

		<H2>参照</H2>
		<P>
			<CODE>
				<A href="CRYPTO_RC4.html">CRYPTO_RC4</A>, <A href="CRYPTO_RC4Init.html">CRYPTO_RC4Init</A>
			</CODE>
		</P>

		<H2>履歴</H2>
		<P>
			2006/02/24 Crypt から Crypto へ変更<BR>
                        2006/01/30 説明を追記<BR>
			2005/12/28 RC4Fast の速度に関する注記を追加・誤記の修正<BR>
			2005/12/27 初版<BR>
		</P>

	</BODY>
</HTML>
