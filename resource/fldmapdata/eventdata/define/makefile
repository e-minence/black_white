#============================================================================
#
#		イベントデータコンバート用Makefile
#
#
#
#
#		2009.05.25	tamada GAME FREAK inc.
#
#============================================================================

#------------------------------------------------------------------------------
#※コンバート作業が必要なユーザーの名前を記述する
#------------------------------------------------------------------------------
include ../../event_script_users_def

#------------------------------------------------------------------------------
#※サブディレクトリでもMakeしたい場合、ここにディレクトリ名を書く
#------------------------------------------------------------------------------
SUBDIRS	=

#共通ルールファイルのインクルード
include $(PROJECT_RSCDIR)\macro_define



TMPDIR	= ../tmp
DATADIR	= ../data
SRCDATA = $(wildcard $(DATADIR)/*.mev)
TGTDATA = $(basename $(notdir $(SRCDATA)))
HEADER = $(addprefix $(TMPDIR)/,$(addsuffix .h,$(TGTDATA)))

TARGET = total_header.h

.PHONY:	do-build clean test

#------------------------------------------------------------------------------
#	make do-build ルール
#------------------------------------------------------------------------------
do-build:	$(TARGET)

ifeq	($(CONVERTUSER),true)	#コンバート対象者のみ動作、ここから
$(TARGET):	$(HEADER)
	cat $(TMPDIR)/*.h > $(TARGET)
	cat $(TMPDIR)/*.tmp > binary_depend_file

$(TMPDIR)/%.h: $(DATADIR)/%.mev
	ruby make_event.rb $<
endif


#------------------------------------------------------------------------------
#	make cleanルール
#------------------------------------------------------------------------------
clean:
ifeq	($(CONVERTUSER),true)	#コンバート対象者のみ動作、ここから
	-rm event_*.h event_*.tmp
	-rm $(HEADER) $(TARGET)
endif

test:
	@echo $(HEADER)

