//======================================================================
//
//                n01r0502.ev
//
//    スクリプトファイル：Ｎの城、謁見の間
//
//
//  N01R0502_BOSS_01          N
//  N01R0502_WKOBJCODE00_01   Nの連れている伝説ポケモン
//  N01R0502_WKOBJCODE01_01   ストーンから誕生する伝説ポケモン
//  N01R0502_SAGE1_01         ゲーチス
//  N01R0502_RIVAL_01         ライバル
//  N01R0502_CHAMPION_01      チャンピオン
//
//
/*
使用可能なアニメコマンド一覧
シンムA( SHIN_A / MU_A )
AC_DIR_U 上向き
AC_SHIN_MU_FLY_L シンム　飛ぶ　左
AC_SHIN_MU_FLY_UPPER シンム　上昇
AC_SHIN_MU_GUTARI シンム　ぐったりアニメ

シンムB( SHIN_B / MU_B )
AC_DIR_U　上向き
AC_DIR_D　下向き
AC_SHIN_MU_HOERU シンム　吠えるアニメ
AC_SHIN_MU_TURN シンム　振り向き

シンムC( SHIN_C / MU_C)
AC_SHIN_MU_C_FLY //<シンムC 滞空アニメ
AC_SHIN_MU_OFFS_CLEAR //描画オフセットをクリア

*/
//
//======================================================================

  .text

  .include  "scr_seq_def.h"
  .include  "msg_n01r0502.h"
  .include  "n01r0502.h"
  .include  "n01r0502_def.h"

//--------------------------------------------------------------
//               スクリプト本体
//--------------------------------------------------------------

//--------------------------------------------------------------
//               スクリプトテーブル
//--------------------------------------------------------------
_EVENT_DATA		ev_zone_n01r0502
_EVENT_DATA		ev_pos_n01r0502_lastbtl_01
_EVENT_DATA		ev_pos_n01r0502_lastbtl_02
_EVENT_DATA		ev_pos_n01r0502_lastbtl_03	//全滅後・Ｎ戦用ＰＯＳ
_EVENT_DATA		ev_scene_n01r0502_lastbtl_04
_EVENT_DATA		ev_n01r0502_boss_01
_EVENT_DATA		ev_n01r0502_wkobjcode00_01
_EVENT_DATA		ev_n01r0502_wkobjcode01_01
_EVENT_DATA		ev_init_n01r0502
_EVENT_DATA		ev_recover_n01r0502
_EVENT_DATA		ev_n01r0502_sage1_01
_EVENT_DATA		ev_n01r0502_champion_01
_EVENT_DATA		ev_n01r0502_rival_01
_EVENT_DATA   ev_reserve_n01r0502_n_battle
_EVENT_DATA   ev_reserve_n01r0502_sage_appear
_EVENT_DATA		ev_pos_n01r0502_lastbtl_04	//全滅後・ゲーチス戦用ＰＯＳ
_EVENT_DATA_END


//このスクリプト全体で使用するローカル変数定義
DEFINE_LOCAL	LWK_ROM

/**************************************************************/
/*               フィールド初期化スクリプト                   */
/**************************************************************/
INIT_EVENT_START 	ev_zone_n01r0502
  _CALL sub_setup_objchr
INIT_EVENT_END


/**************************************************************/
/*			フィールドイニットスクリプト					  */
/**************************************************************/
INIT_EVENT_START	ev_init_n01r0502
  _CALL sub_setup_objpos
INIT_EVENT_END

/**************************************************************/
/*			フィールドリカバースクリプト					  */
/**************************************************************/
INIT_EVENT_START	ev_recover_n01r0502
  //_CALL sub_setup_objpos
INIT_EVENT_END


sub_setup_objchr:
	//可変OBJの確定
	_GET_ROM_VERSION( SCWK_ANSWER )
	IF $SCWK_ANSWER == VERSION_WHITE THEN
		IF $WK_SCENE_N01R0502 == 4 THEN 
			$OBJCHRWORK0 = SHIN_A	//シン
		ELSIF $WK_SCENE_N01R0502 == 5 THEN
			$OBJCHRWORK0 = SHIN_C	//シン
		ELSE
			$OBJCHRWORK0 = SHIN_B	//シン
		ENDIF
		
		$OBJCHRWORK1 = MU_B		//ム
	
	ELSE
		IF $WK_SCENE_N01R0502 == 4 THEN 
			$OBJCHRWORK0 = MU_A		//ム
		ELSIF $WK_SCENE_N01R0502 == 5 THEN
			$OBJCHRWORK0 = MU_C	//ム
		ELSE
			$OBJCHRWORK0 = MU_B		//ム
		ENDIF
		
		$OBJCHRWORK1 = SHIN_B	//シン
	
	ENDIF

  _RET

sub_setup_objpos:
	//シーン毎のOBJPOSチェンジ
	//Ｎの戦闘前
	SWITCH $WK_SCENE_N01R0502
	CASE 1 THEN		//一番初めのＰＯＳ起動後の場合
		_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 2, 18, DIR_DOWN )
	CASE 2 THEN   //2番目のPOS起動後（伝説出現後）の場合
		_OBJ_POS_CHANGE( N01R0502_WKOBJCODE00_01, 16, 0, 35, DIR_DOWN )
		_OBJ_POS_CHANGE( N01R0502_WKOBJCODE01_01, 16, 0, 39, DIR_DOWN )
		_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 36, DIR_DOWN )
	CASE 3 THEN		//Ｎ戦前
		_OBJ_POS_CHANGE( N01R0502_WKOBJCODE00_01, 16, 0, 35, DIR_DOWN )
		_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 36, DIR_DOWN )
	CASE 4 THEN		//シン（ム）・ゲーチス連戦前
		_OBJ_POS_CHANGE( N01R0502_BOSS_01, 17, 0, 39, DIR_LEFT )
	CASE 5 THEN		//ゲーチス戦で負けた場合
		_OBJ_POS_CHANGE( N01R0502_CHAMPION_01, 15, 0, 40, DIR_UP )
		_OBJ_POS_CHANGE( N01R0502_RIVAL_01, 17, 0, 40, DIR_UP )
		_OBJ_POS_CHANGE( N01R0502_SAGE1_01, 16, 0, 38, DIR_DOWN )
		_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 36, DIR_DOWN )
	ENDSWITCH
  _RET

/************************************************************/
/*	最終イベント１	WK_SCENE_N01R0502=0起動					*/
//  玉座にカメラ移動、Ｎのセリフ、カメラ元に戻る
/************************************************************/
EVENT_START	ev_pos_n01r0502_lastbtl_01

	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く
	
	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,196655,819200,70 )	//一番最後の引数は移動にかかるフレーム数
	//ダミーの主人公OBJ表示
{
	DEFINE_LOCAL LWK_POSX
	DEFINE_LOCAL LWK_POSZ
	DEFINE_LOCAL LWK_SEX
	
	_PLAYER_POS_GET( LWK_POSX,LWK_POSZ )
	_GET_MY_SEX( LWK_SEX )

  IF $LWK_SEX == PM_MALE THEN
    _OBJ_ADD_EX( LWK_POSX,47,DIR_UP,MMDL_ID_EVENTOBJ_00,HERO,MV_DMY )
  ELSE
    _OBJ_ADD_EX( LWK_POSX,47,DIR_UP,MMDL_ID_EVENTOBJ_00,HEROINE,MV_DMY )
  ENDIF

	//透明の主人公が移動
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_camera_move1 )
	_OBJ_ANIME_WAIT()

	_CAMERA_WAIT_MOVE()	//カメラ移動待ち
	_TIME_WAIT( 20 )
	//メッセージ
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_01w, msg_n01r0502_boss_01b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()	

	_CAMERA_MOVE( 9688,0,970752,1081344,131103,1212416,50 )	//一番最後の引数は移動にかかるフレーム数

	//Ｎ：数歩前に移動
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_last1_move )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()	//カメラ移動待ち
	
	//ボクが　のぞむのは　ポケモンだけの　せかい
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_01_01w, msg_n01r0502_boss_01_01b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//自機にカメラを戻す
	_CAMERA_RECV_MOVE( 70 )	//_CAMERA_START()を使った時の座標に戻します。引数は移動にかかるフレーム数です
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_camera_move2 )
	_OBJ_ANIME_WAIT()

	_CAMERA_WAIT_MOVE()	//カメラ移動待ち
	_CAMERA_BIND()		//カメラバインド　主人公位置をカメラが追従するようになります
	_CAMERA_END()		//カメラ操作終了
	
	_OBJ_DEL( MMDL_ID_EVENTOBJ_00 )
}

	//========================================/
	
	//WKを１にする
	$WK_SCENE_N01R0502 = 1
	
	//========================================/

EVENT_END

//--------------------------------------------------------------------
//		カメラ移動
//--------------------------------------------------------------------
_ANIME_LABEL	anm_camera_move1
	_ANIME_DATA	AC_VANISH_ON,1
	_ANIME_DATA	AC_WALK_U_2F,35
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_camera_move2
	_ANIME_DATA	AC_WALK_D_2F,35
	_ANIME_DATA	AC_DIR_U,1
	_ANIME_DATA	AC_VANISH_OFF,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_last1_move
	_ANIME_DATA	AC_WALK_D_8F,6
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

/************************************************************/
/*	最終イベント２	WK_SCENE_N01R0502=1起動					*/
//  Ｎのセリフ、Ｎの手持ち伝説ポケ登場
//  （NEW）ライトストーン発動、誕生デモ、Ｎのセリフ→フリームーブへ
/************************************************************/
EVENT_START		ev_pos_n01r0502_lastbtl_02

  //Ｎのセリフ、手持ち伝説ポケモン登場
  _CALL sub_NsLegend_appear

  //伝説ポケモン誕生
  _CALL sub_legend_born

	//========================================/
	
	//ライトストーンイベント終了
	$WK_SCENE_N01R0502 = 2
		
	//========================================/

EVENT_END

/************************************************************/
//  Ｎのセリフ、Ｎの手持ち伝説ポケ登場
/************************************************************/
sub_NsLegend_appear:
{
	DEFINE_LOCAL LWK_POSX1
	DEFINE_LOCAL LWK_POSZ1
	
	_PLAYER_POS_GET( LWK_POSX1,LWK_POSZ1 )

	//X軸が15の場合
	IF $LWK_POSX1 == 14 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_last14 )
	//X軸が16の場合	
	ELSIF $LWK_POSX1 == 15 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_last15 )
	//X軸が16の場合	
	ELSIF $LWK_POSX1== 16 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_last16 )
	//X軸が16の場合	
	ELSIF $LWK_POSX1 == 17 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_last17 )
	//X軸が18の場合
	ELSE
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_last18 )
	ENDIF
}
	//Ｎ：自機の前に移動
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_last2 )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く
	
	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,30 )	//一番最後の引数は移動にかかるフレーム数
	_CAMERA_WAIT_MOVE()

	//Ｎ：横向き
	_OBJ_ANIME( N01R0502_BOSS_01, anm_slow_r )
	_OBJ_ANIME_WAIT()

	_TIME_WAIT(30)

	//ボクは　すこしだけ　キミのことを　きにいっていたのかも
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_03w, msg_n01r0502_boss_03b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//Ｎ:自機のほうを見る
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_turn )
	_OBJ_ANIME_WAIT()

	//首振りアニメ
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_kubi )
	_OBJ_ANIME_WAIT()

	//だけど　ちがった　いま　すごく　ガッカリしているよ
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_04w, msg_n01r0502_boss_04b, N01R0502_BOSS_01, POS_DEFAULT )
	
	//キミに　できることは　２つ！
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_04_01w, msg_n01r0502_boss_04_01b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//両手アニメ
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_hand2 )
	_OBJ_ANIME_WAIT()

	//おいで　シン！/ム！
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_05w, msg_n01r0502_boss_05b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//シンとムの鳴き声
	_CALL sub_voice_play_n_legend
	_VOICE_WAIT()
	//デモ再生：シン（ム）が謁見の間に突っ込んでくるデモ
	_DEMO_FADEOUT_BLACK_WITH_BGM_CALL()
	
	//フラグリセット
	_FLAG_RESET( FV_N01R0502_LEGEND_01 )
	_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 37, DIR_DOWN )
	_OBJ_ADD( N01R0502_WKOBJCODE00_01 )
	
	//謁見の間、水が干上がった状態のマップに変更
	_CHANGE_MAPREPLACE_FLAG( MAPREPLACE_ID_04, TRUE, TRUE )

	_GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_CALL_3D_DEMO( DEMO3D_ID_N_LEGEND_COME_W )
		ELSE
			_CALL_3D_DEMO( DEMO3D_ID_N_LEGEND_COME_B )
		ENDIF

	_DEMO_FADEIN_BLACK_WITH_BGM_CALL()

_RET
	

//--------------------------------------------------------------------
//	lastbtl２用アニメ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_n_last2
	_ANIME_DATA	AC_WALK_D_2F,14
	_ANIME_DATA	AC_WALK_D_8F,5
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_last14
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	AC_WALK_R_8F,2
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_last15
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_player_last16
	_ANIME_DATA	AC_WALK_U_8F,3
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_last17
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_last18
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	AC_WALK_L_8F,2
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

/************************************************************/
//  伝説ポケモン誕生
/************************************************************/
sub_legend_born:

	_TIME_WAIT( 30 )

	_SE_PLAY(SEQ_SE_END_02)
	_SHAKE_CAMERA(4,0,4,5,1,0,1,3)
	_SE_WAIT()
	
	_TIME_WAIT( 30 )

    //バッグの　なか……
    _GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_SYSWIN_MSG( msg_n01r0502_stone_02w , POS_DOWN )
		ELSE
			_SYSWIN_MSG( msg_n01r0502_stone_02b , POS_DOWN )
		ENDIF
	_AB_KEYWAIT_MARK()
	_SYSWIN_CLOSE()

	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く
	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,20 )	//一番最後の引数は移動にかかるフレーム数	

	//主人公にビックリマーク表示
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_bikkuri )
	_OBJ_ANIME_WAIT()

	//Ｎ後ずさり
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_back ) 
	_OBJ_ANIME_WAIT()

	//キミの　もつ
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_07w, msg_n01r0502_boss_07b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//自機一歩下がる
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_back )
	_OBJ_ANIME_WAIT()

	//ダーク（ライト）ストーンの演出
	_START_LEG_GMK()
	//無音にする
	_START_EVENT_BGM_EX( SEQ_BGM_SILENCE_DUNGEON, BGM_FADE_VSHORT )

	//〜〜〜ストーンが　はげしく　かがやきだす……！
	_GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_SYSWIN_MSG( msg_n01r0502_stone_03w , POS_DOWN )
			_SUB_ITEM( ITEM_DAAKUSUTOON,1,SCWK_ANSWER )
		ELSE
			_SYSWIN_MSG( msg_n01r0502_stone_03b , POS_DOWN )
			_SUB_ITEM( ITEM_RAITOSUTOON,1,SCWK_ANSWER )
		ENDIF
	_TIME_WAIT( 50 )
    _SYSWIN_CLOSE()

	//デモ再生：ム（シン）石から復活デモ
	_DEMO_FADEOUT_BLACK_CALL()

	_GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_CALL_3D_DEMO( DEMO3D_ID_N_LEGEND_BORN_W )
		ELSE
			_CALL_3D_DEMO( DEMO3D_ID_N_LEGEND_BORN_B )
		ENDIF
	//========================================/
	
	//フラグセット
	_FLAG_RESET( FV_N01R0502_LEGEND_02 )
	
	//========================================/
	
	_OBJ_ADD( N01R0502_WKOBJCODE01_01 )
	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く

	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2392064,1 )	//一番最後の引数は移動にかかるフレーム数
	
	_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 36, DIR_DOWN )
	
	_DEMO_FADEIN_BLACK_CALL()
	_END_EVENT_BGM_EX( BGM_FADE_VSHORT )

	//シンと　ムは……　もとは　ひとつの　いのち
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_08w, msg_n01r0502_boss_08b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//その　ポケモンが　なんといっているか　おしえてあげるよ
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_09w, msg_n01r0502_boss_09b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//自機にカメラを戻す
	_CAMERA_RECV_MOVE( 40 )	//_CAMERA_START()を使った時の座標に戻します。引数は移動にかかるフレーム数です

	_CAMERA_WAIT_MOVE()	//カメラ移動待ち
	_CAMERA_BIND()		//カメラバインド　主人公位置をカメラが追従するようになります
	_CAMERA_END()		//カメラ操作終了
	
  _RET

//--------------------------------------------------------------------
//	Ｎはなしかけ用アニメ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_package_dir
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_n_move
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_WALK_D_8F,4
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_back
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_U_16F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_back
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_D_16F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL  anm_bikkuri
  _ANIME_DATA AC_MARK_GYOE,1
  _ANIME_DATA ACMD_END,0

/************************************************************/
/*	最終イベント３	Ｎ戦で全滅した用	*/
/************************************************************/
EVENT_START	ev_pos_n01r0502_lastbtl_03
{
	DEFINE_LOCAL LWK_POSX1
	DEFINE_LOCAL LWK_POSZ1
	
	_PLAYER_POS_GET( LWK_POSX1,LWK_POSZ1 )

	//X軸が14の場合
	IF $LWK_POSX1 == 14 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl3_last14 )
	//X軸が15の場合	
	ELSIF $LWK_POSX1 == 15 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl3_last15 )
	//X軸が16の場合	
	ELSIF $LWK_POSX1== 16 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl3_last16 )
	//X軸が17の場合	
	ELSIF $LWK_POSX1 == 17 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl3_last17 )
	//X軸が18の場合
	ELSE
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl3_last18 )
	ENDIF
	
	_OBJ_ANIME_WAIT()

	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く

	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,30 )
	_CAMERA_WAIT_MOVE()

	_CALL sub_n_battle

	_CAMERA_END()

}
EVENT_END

_ANIME_LABEL	anm_btl3_last14
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_R_8F,2
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_btl3_last15
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_btl3_last16
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_btl3_last17
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_btl3_last18
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_L_8F,2
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0


/************************************************************/
/*	最終イベント４											*/
/************************************************************/
EVENT_START		ev_scene_n01r0502_lastbtl_04
EVENT_END

//--------------------------------------------------------------------
//	LASTBTL4用アニメ
//--------------------------------------------------------------------

_ANIME_LABEL	anm_stay_u
	_ANIME_DATA	AC_STAY_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_stay_d
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_stay_l
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_stay_r
	_ANIME_DATA	AC_STAY_WALK_R_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_slow_r
	_ANIME_DATA	AC_WALK_R_16F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_turn
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//		芝居・共通アニメ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_n_kubi
	_ANIME_DATA	AC_N_ACT1,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_n_hand
	_ANIME_DATA	AC_N_ACT0,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_hand2
	_ANIME_DATA	AC_N_ACT2,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_sage1_hand
	_ANIME_DATA	AC_SAGE1_ACT0,1
	_ANIME_DATA	ACMD_END,0

/************************************************************/
//  Ｎへの話しかけ
//  基本的にはWK_SCENE_N01R0502が2,3,4の場合しかありえないはず
/************************************************************/
EVENT_START		ev_n01r0502_boss_01
_TALK_OBJ_START()

	SWITCH $WK_SCENE_N01R0502
	CASE  0,1,2 THEN

		//「こころして　かかりたまえ
		_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_10w, msg_n01r0502_boss_10b, N01R0502_BOSS_01, POS_DEFAULT )
		_LAST_KEYWAIT()
		_MSGWIN_CLOSE()

	CASE  3 THEN

		//この状態では話しかけることが出来ません。（イベントはPOS起動になっております）
		_CALL sub_n_battle

	CASE  4,5 THEN

		//未使用ラベルです、本編中にこのメッセージが表示される事はありません。
		_BALLOONWIN_TALKOBJ_MSG( msg_n01r0502_rematch_boss )
		_LAST_KEYWAIT()
		_MSGWIN_CLOSE()

	ENDSWITCH

EVENT_END

/************************************************************/
//  対Ｎ戦
/************************************************************/
EVENT_START ev_reserve_n01r0502_n_battle

    _CALL sub_n_battle

EVENT_END

sub_n_battle:

  	//「絶対に　勝つ！！
	_GIZAWIN_OBJMSG_POS( msg_n01r0502_boss_battle_02 , N01R0502_BOSS_01, POS_DEFAULT )
	_GIZAWIN_CLOSE()

	//N・自機　一歩前へ
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_battle_01 )
	_OBJ_ANIME( N01R0502_BOSS_01, anm_battle_02 )
	_OBJ_ANIME_WAIT()

  //戦闘呼び出し
	_GET_ROM_VERSION( LWK_ROM )
	IF $LWK_ROM == VERSION_WHITE THEN
		_TRAINER_BTL_SET( TRID_BOSS_2_06, 0 )
	ELSE
		_TRAINER_BTL_SET( TRID_BOSS_2_07, 0 )
	ENDIF

  //敗戦チェック
  _TRAINER_LOSE_CHECK( SCWK_ANSWER )
  
  IF $SCWK_ANSWER == SCR_BATTLE_RESULT_WIN THEN
    _OBJ_POS_CHANGE( MMDL_ID_PLAYER, 16, 0, 39, DIR_UP )
	_OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 36, DIR_DOWN )
  
	//可変OBJの確定
	IF $LWK_ROM == VERSION_WHITE THEN
		$OBJCHRWORK0 = SHIN_A	//シン
    ELSE
		$OBJCHRWORK0 = MU_A		//ム
    ENDIF
	_OBJ_DEL( N01R0502_WKOBJCODE00_01 )
	
	//========================================/
	_FLAG_SET(FV_N01R0502_LEGEND_01)
	//========================================/

    _TRAINER_WIN()			//勝ち(1)ならトレーナー勝利処理へ
  
  ELSE
  
    _TRAINER_LOSE()			//負け(0)ならトレーナー敗北処理へ(ここでスクリプト終了します）
  
  ENDIF

	//========================================/
  $WK_SCENE_N01R0502 = 4    //対ゲーチス戦へ
	//========================================/

  //ゲーチスの登場に続く…
  _RESERVE_SCRIPT( SCRID_RESERVE_N01R0502_SAGE_APPEAR )

_RET

//--------------------------------------------------------------------
//		バトル前アニメ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_battle_01
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_STAY_WALK_U_4F,1
	_ANIME_DATA	AC_WALK_U_4F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_battle_02
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_STAY_WALK_D_4F,1
	_ANIME_DATA	AC_WALK_D_4F,1
	_ANIME_DATA	ACMD_END,0

/************************************************************/
//  話しかけ：Ｎの連れている伝説ポケモン
/************************************************************/
EVENT_START		ev_n01r0502_wkobjcode00_01
_TALK_START_TURN_NOT()

IF $WK_SCENE_N01R0502 >= 4 THEN

    _CALL sub_voice_play_n_legend
    
	_GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_BALLOONWIN_TALKOBJ_MSG( msg_n01r0502_rematch_pokemon_01w )
		ELSE
			_BALLOONWIN_TALKOBJ_MSG( msg_n01r0502_rematch_pokemon_01b )
		ENDIF	
	_VOICE_WAIT()
	_LAST_KEYWAIT()
    _MSGWIN_CLOSE()
    

ELSE
  //それ以外

    _CALL sub_voice_play_n_legend
    _GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_GIZAPLAINWIN_MSG_POS( msg_n01r0502_pokemon_01b, POS_UP )
		ELSE
			_GIZAPLAINWIN_MSG_POS( msg_n01r0502_pokemon_01w, POS_UP )
		ENDIF
	_VOICE_WAIT()
	_LAST_KEYWAIT()
	_GIZAPLAINWIN_CLOSE()
	

ENDIF

EVENT_END

/************************************************************/
//  話しかけ：ストーンから誕生した伝説ポケモン
/************************************************************/
EVENT_START		ev_n01r0502_wkobjcode01_01
_TALK_START_TURN_NOT()

  //伝説ポケモン戦（負けたらこのサブルーチンから帰ってこない）
	_CALL sub_legend_battle

  _CALL sub_empty_check   //戻り値：SCWK_ANSWER == TRUEのとき、手持ちもボックスもいっぱい
  IF FLAG_OFF( FE_PACKAGE_POKE_GET ) && $SCWK_ANSWER == FALSE THEN
	//  捕獲していなくて、なおかつ手持ちもボックスもいっぱいじゃない場合
  //  もう一度伝説ポケモン戦にトライする状況になる

    _OBJ_ANIME( N01R0502_WKOBJCODE01_01, anm_dir_d )
    _OBJ_ANIME_WAIT()

    _PLAYER_NAME( 0 )
    _GET_ROM_VERSION( LWK_ROM )
    IF $LWK_ROM == VERSION_WHITE THEN
      _SYSWIN_MSG( msg_n01r0502_pokemon_02w , POS_DOWN )
    ELSE
      _SYSWIN_MSG( msg_n01r0502_pokemon_02b , POS_DOWN )
    ENDIF
    _LAST_KEYWAIT()
    _SYSWIN_CLOSE()

  ELSE
	// FLAG_ON( FE_PACKAGE_POKE_GET ) || $SCWK_ANSWER == TRUE の場合
	//  つまり、捕獲の場合 or 結果に関わらず手持ちもボックスもいっぱいの場合は
  //  ゲームを進行する

		//Ｎが主人公の方を向く
		_OBJ_ANIME( N01R0502_BOSS_01, anm_dir_d )
		_OBJ_ANIME_WAIT()

		//========================================/
		
		//画面復帰時にいないOBJを参照してしまうので、ここで値を３にする
		$WK_SCENE_N01R0502 = 3

		//========================================/

		//伝説ポケモンを（なるべく）手に入れる処理
    IF FLAG_ON( FE_PACKAGE_POKE_GET ) THEN
        _CALL sub_add_legend
    ENDIF

		_CAMERA_START()		//カメラ操作開始
		_CAMERA_PURGE()		//カメラのバインドを解く
	
		//カメラ操作　Ｎの位置にカメラを合わせる
		_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,20 )
		_CAMERA_WAIT_MOVE()

		_CRIMAX_DEMO_COMMAND( SCR_CRIMAX_CMD_TEMOTI_CHECK, SCWK_ANSWER )
		//手持ちに伝説ポケモンがいたら
		IF $SCWK_ANSWER == TRUE THEN

			//「……そうか　真実を追い求める英雄に
			_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_11w, msg_n01r0502_boss_11b, N01R0502_BOSS_01, POS_DEFAULT )
    		_MSGWIN_CLOSE()
    		
    	ENDIF

		//自機にカメラを戻す
		_CAMERA_RECV_MOVE( 40 )	//_CAMERA_START()を使った時の座標に戻します。引数は移動にかかるフレーム数です

		//Ｎ：自機の横に移動
		_OBJ_ANIME( N01R0502_BOSS_01, anm_n_move )
		_OBJ_ANIME_WAIT()
		
		_CAMERA_WAIT_MOVE()	//カメラ移動待ち
    	
    	_OBJ_ANIME( MMDL_ID_PLAYER, anm_dir_r )
    	_OBJ_ANIME_WAIT()
    	
		//「さて……　キミのポケモンが　きずついている
    	_PLAYER_NAME( 0 )
		_BALLOONWIN_OBJMSG( msg_n01r0502_boss_battle_01, N01R0502_BOSS_01 )
		_MSGWIN_CLOSE()
    
		//「Ｎは　〜のポケモンを　かいふくさせた！
		_PLAYER_NAME( 0 )
		_SE_PLAY( SEQ_SE_RECOVERY )
		_SYSWIN_MSG( msg_n01r0502_boss_heal_01, POS_DOWN )
		_SE_WAIT()
		_AB_KEYWAIT_MARK()
		_SYSWIN_CLOSE()

		//回復
		_TEMOTI_POKEMON_KAIFUKU()

		//カメラ操作　Ｎの位置にカメラを合わせる
		_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,20 )

		//Ｎ：シン（ム）の前に移動
    	_OBJ_ANIME( MMDL_ID_PLAYER, anm_dir_u )
		_OBJ_ANIME( N01R0502_BOSS_01, anm_n_lastbtl5 )
		_OBJ_ANIME_WAIT()
	
		_CAMERA_WAIT_MOVE()
		
		//Ｎとの戦いに続く…
		 _CALL sub_n_battle
	
		_CAMERA_END()
	
	ENDIF

EVENT_END

/************************************************************/
//  伝説ポケモン戦
/************************************************************/
sub_legend_battle:
{	
  DEFINE_LOCAL	LWK_DIR
	//自機：一歩前に戻る
	_PLAYER_DIR_GET( LWK_DIR )
	SWITCH $LWK_DIR
	CASE DIR_UP THEN
	CASE DIR_DOWN THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_last6_d )
	CASE DIR_RIGHT THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_last6_r )
	CASE DIR_LEFT THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_last6_l )
	ENDSWITCH
	_OBJ_ANIME_WAIT()
}

	_OBJ_ANIME( N01R0502_WKOBJCODE01_01, anm_legend_hoeru )
	_OBJ_ANIME_WAIT()

    //対戦前に、ボックス＋手持ちがいっぱいか？のチェック結果を保存
    DEFINE_LOCAL  LWK_EMPTY_CHECK
    _CALL sub_empty_check
    $LWK_EMPTY_CHECK = $SCWK_ANSWER 

    DEFINE_LOCAL  LWK_BATTLE_FLAG

    //シン・ム専用、伝説系MSG、レア無し
    $LWK_BATTLE_FLAG = SCR_WILD_BTL_FLAG_IMMORTAL
    $LWK_BATTLE_FLAG |= SCR_WILD_BTL_FLAG_LEGEND
    $LWK_BATTLE_FLAG |= SCR_WILD_BTL_FLAG_NO_RARE

    _CALL sub_voice_play_mine_legend
    _GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_BLACK THEN
			_GIZAPLAINWIN_MSG_POS( msg_n01r0502_pokemon_01b,POS_DEFAULT )
			_VOICE_WAIT()
			_AB_KEYWAIT_MARK()
			_GIZAPLAINWIN_CLOSE()

			_WILD_BTL_SET_EX( MONSNO_650, 50, LWK_BATTLE_FLAG )
		ELSE
			_GIZAPLAINWIN_MSG_POS( msg_n01r0502_pokemon_01w,POS_DEFAULT )
			_VOICE_WAIT()
			_AB_KEYWAIT_MARK()
			_GIZAPLAINWIN_CLOSE()

			_WILD_BTL_SET_EX( MONSNO_651, 50, LWK_BATTLE_FLAG )
		ENDIF

    _WILD_LOSE_CHECK( SCWK_ANSWER )
    
    IF $SCWK_ANSWER == SCR_BATTLE_RESULT_WIN THEN
        //勝利
        _OBJ_POS_CHANGE( N01R0502_BOSS_01, 16, 0, 36, DIR_DOWN )
        
        _WILD_RETRY_CHECK( SCWK_ANSWER )
        IF $SCWK_ANSWER == SCR_WILD_BTL_RET_CAPTURE THEN
          //========================================/
            _FLAG_SET( FE_PACKAGE_POKE_GET )
          //========================================/
        ENDIF

        //捕獲したか、手持ちにもボックスにも空きがなかった場合は伝説ポケを消して話を進める
        IF ($SCWK_ANSWER == SCR_WILD_BTL_RET_CAPTURE) || ($LWK_EMPTY_CHECK == TRUE) THEN
          //========================================/
          
          //シンのOBJ削除
          _OBJ_DEL( N01R0502_WKOBJCODE01_01 )
          
          //フラグセット
          _FLAG_SET( FV_N01R0502_LEGEND_02 )
          
          //========================================/
        ENDIF

        _WILD_WIN()			//勝ち(1)ならトレーナー勝利処理へ
    
    ELSE
        //負けた場合
        _WILD_LOSE()		//負け(0)ならトレーナー敗北処理へ(ここでスクリプト終了します）
      
    ENDIF
			
_RET

//--------------------------------------------------------------------
//		シンとム専用のアニメ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_legend_hoeru
	_ANIME_DATA	AC_SHIN_MU_HOERU,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_legend_turn
	_ANIME_DATA	AC_SHIN_MU_TURN,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_legend_gutari
	_ANIME_DATA	AC_SHIN_MU_GUTARI,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_legend_last
	_ANIME_DATA	AC_SHIN_MU_C_FLY,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//		話しかけた場合の回り込み処理
//--------------------------------------------------------------------
_ANIME_LABEL	anm_last6_r
	_ANIME_DATA	AC_WALK_D_8F,1
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_STAY_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_last6_l
	_ANIME_DATA	AC_WALK_D_8F,1
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_STAY_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_last6_d
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_WALK_D_8F,2
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_STAY_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

/************************************************************/
//  Ｎが迷って、ゲーチス登場
/************************************************************/
EVENT_START ev_reserve_n01r0502_sage_appear

    _CALL sub_sage_appear

    //========================================/
    
    //$WK_SCENE_N01R0502を５にして終了
    $WK_SCENE_N01R0502 = 5

    //チャンピオンの間のワークを２にする
    $WK_SCENE_C09R0501 = 2

    //ポケモンリーグのチャンピオンとライバル削除
    _FLAG_SET( FV_C09R0501_RIVAL_01 )
    _FLAG_SET( FV_C09R0501_CHAMPION_01 )
    _FLAG_SET( FV_N01R0501_SAGE1 )

    //========================================/

    _CALL ev_last

EVENT_END

sub_sage_appear:

	_TIME_WAIT(30)
	
	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く
	
	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2392064,15 )
	_CAMERA_WAIT_MOVE()

	//「上回ったか…
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_boss_06w, msg_n01r0502_boss_06b, N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//Ｎのアップ絵表示　※プレーンウィンドウを出すたびにアニメのリクエストをしましょう
	_START_FACEUP( FLD_FACEUP_BG_CATSLE, FLD_FACEUP_CHAR_BOSS, FALSE )

	_GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
      _START_FACEUP_ANM() //顔アップの口パク目パチ開始
			_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_12w )
      _START_FACEUP_ANM() //顔アップの口パク目パチ開始
			_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_12_01w )
			_PLAINWIN_CLOSE()
		ELSE
      _START_FACEUP_ANM() //顔アップの口パク目パチ開始
			_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_12b )
      _START_FACEUP_ANM() //顔アップの口パク目パチ開始
			_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_12_01b )
			_PLAINWIN_CLOSE()
		ENDIF

	//Ｎのアップ絵終了
	_END_FACEUP()

	//Ｎ：自機に背を向ける
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_l )
	_OBJ_ANIME_WAIT()
	
	//無音にする
	_START_EVENT_BGM_EX( SEQ_BGM_SILENCE_DUNGEON, BGM_FADE_MIDDLE )

	_TIME_WAIT( 15 )

	//ゲーチス：登場
	_FLAG_RESET( FV_N01R0502_EVENT_01 )
	_OBJ_ADD( N01R0502_SAGE1_01 )
	_OBJ_ADD( N01R0502_CHAMPION_01 )
	_OBJ_ADD( N01R0502_RIVAL_01 )

	//ゲーチス：近づく
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_come )
	_OBJ_ANIME_WAIT()

	//イベント曲再生
	_START_TEMP_EVENT_BGM( SEQ_BGM_E_G_CIS )

	//カメラ操作　ゲーチスの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2654208,30 )
	_CAMERA_WAIT_MOVE()

	//それでも　ワタクシと　おなじ　ハルモニア
	_BALLOONWIN_OBJMSG( msg_n01r0502_sage1_01 , N01R0502_SAGE1_01 )
	_MSGWIN_CLOSE()

	//カメラ操作　ゲーチスの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1212416,0,2588672,30 )

	_OBJ_ANIME( N01R0502_BOSS_01, anm_dir_d )
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_wait_come2 )
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_come2 )
	_OBJ_ANIME_WAIT()
	
	//そなたには　この　ぎょくざは
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_sage1_02w, msg_n01r0502_sage1_02b, N01R0502_SAGE1_01, POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,60 )

	//自機・Ｎ：ゲーチスのほうを向く　ゲーチス：Ｎに近づく
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_come2a )
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_look1 )
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_look1 )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()	//カメラ移動待ち

	//だが　それでは　この　Ｎが
	_BALLOONWIN_OBJMSG( msg_n01r0502_sage1_03 , N01R0502_SAGE1_01 )
	_MSGWIN_CLOSE()
	
	//ゲーチス：主人公の方を向いて
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_come3 )
	_OBJ_ANIME( N01R0502_BOSS_01, anm_dir_d )
	_OBJ_ANIME_WAIT()
	
	//そこで　えらばれたのが　！　キミですよ
	_PLAYER_NAME( 0 )
	_BALLOONWIN_OBJMSG( msg_n01r0502_sage1_04 , N01R0502_SAGE1_01 )

	_BALLOONWIN_OBJMSG( msg_n01r0502_sage1_05 , N01R0502_SAGE1_01 )
	_MSGWIN_CLOSE()
	
	//ライバル：近づく
	_OBJ_ANIME( N01R0502_RIVAL_01, anm_rival_come )
	_OBJ_ANIME( N01R0502_CHAMPION_01, anm_chanpion_come )
	_OBJ_ANIME_WAIT()
	
	//しはいだって？　プラズマだんの　もくてきは
	_BALLOONWIN_OBJMSG( msg_n01r0502_black_01 , N01R0502_RIVAL_01 )
	_MSGWIN_CLOSE()

	//ゲーチス：Ｎの前へ横切る・ジェスチャー
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_come4 )
	_OBJ_ANIME_WAIT()

	//あれは　プラズマだんを　つくりあげるための　ウソ
	_BALLOONWIN_OBJMSG( msg_n01r0502_sage1_06 , N01R0502_SAGE1_01 )
	_MSGWIN_CLOSE()
	
	//きさま　そんな　くだらぬ　かんがえで
	_BALLOONWIN_OBJMSG( msg_n01r0502_champion_01 , N01R0502_CHAMPION_01 )
	_MSGWIN_CLOSE()

	//ゲーチス：自機達のほうを見て
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_stay_d )
	_OBJ_ANIME_WAIT()

	//なんとでも　さて　かみと　よばれようと
	_PLAYER_NAME(0)
	_BALLOONWIN_OBJMSG( msg_n01r0502_sage1_07 , N01R0502_SAGE1_01 )
	_MSGWIN_CLOSE()

	//ゲーチス：自機の前に移動
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_come5 )
	_OBJ_ANIME_WAIT()

	//レシラム/ゼクロム！　キミの　ちからを
	_PLAYER_NAME(0)
	_GET_ROM_VERSION( LWK_ROM )
	IF $LWK_ROM == VERSION_WHITE THEN
		_PLAINWIN_MSG_UP( msg_n01r0502_boss_11 )
	ELSE
		_PLAINWIN_MSG_UP( msg_n01r0502_boss_12 )
	ENDIF
	_PLAINWIN_CLOSE()
	
	_TIME_WAIT( 15 )
	
	_SE_PLAY(SEQ_SE_FLD_176)
	//回復
	_TEMOTI_POKEMON_KAIFUKU()
	_SE_WAIT()
	
	_TIME_WAIT( 15 )

	//ゲーチス：片手アニメ
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_sage1_hand )
	_OBJ_ANIME_WAIT()
	
	_GIZAWIN_OBJMSG_POS( msg_n01r0502_sage1_02 , N01R0502_SAGE1_01, POS_UP )
	_GIZAWIN_CLOSE()

  _RET

/************************************************************/
/*	最終イベント４	ゲーチス戦で全滅した用	*/
/************************************************************/
EVENT_START	ev_pos_n01r0502_lastbtl_04
{
	DEFINE_LOCAL LWK_POSX1
	DEFINE_LOCAL LWK_POSZ1
	
	_PLAYER_POS_GET( LWK_POSX1,LWK_POSZ1 )

	//X軸が14の場合
	IF $LWK_POSX1 == 14 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl4_last14 )
	//X軸が15の場合	
	ELSIF $LWK_POSX1 == 15 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl4_last15 )
	//X軸が16の場合	
	ELSIF $LWK_POSX1== 16 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl4_last16 )
	//X軸が17の場合	
	ELSIF $LWK_POSX1 == 17 THEN
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl4_last17 )
	//X軸が18の場合
	ELSE
		_OBJ_ANIME( MMDL_ID_PLAYER, anm_btl4_last18 )
	ENDIF
	
	_OBJ_ANIME_WAIT()

	_CAMERA_START()		//カメラ操作開始
	_CAMERA_PURGE()		//カメラのバインドを解く
	
	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,60 )
	_CAMERA_WAIT_MOVE()	//カメラ移動待ち

	//ゲーチス：片手アニメ
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_sage1_hand )
	_OBJ_ANIME_WAIT()

	_CALL ev_last

}
EVENT_END

_ANIME_LABEL	anm_btl4_last14
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_R_8F,2
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_btl4_last15
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_btl4_last16
	_ANIME_DATA	AC_WALK_U_8F,3
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_btl4_last17
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_btl4_last18
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_L_8F,2
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0

/************************************************************/
/*	ラストシーン											*/
/************************************************************/
ev_last:
	//BGMチェンジでの環境SEポーズ状態をCLEAR（GFBTS1652の対処：斉藤優史）
	//戦闘負け後はフィールド構築がされずこのコマンドが使用できないため、ここでクリアしています。
	//謁見の間では環境SEがないので、ここでクリアしても実際のプレイでは何も問題ありません。アッパーで環境SEが追加されたら要確認。
	_CLEAR_ENVSE_EVENT_BGMPLAY_PAUSE()

	//戦闘呼び出し
	_TRAINER_BTL_SET( TRID_SAGE1_01, 0 )
	//敗戦チェック
	_TRAINER_LOSE_CHECK( SCWK_ANSWER )
	IF $SCWK_ANSWER == SCR_BATTLE_RESULT_WIN THEN

		_CAMERA_START()		//カメラ操作開始
		_CAMERA_PURGE()		//カメラのバインドを解く

		//カメラ操作　Ｎの位置にカメラを合わせる
		_CAMERA_MOVE( 9688,0,970752,1081344,0,2457600,1 )
		_CAMERA_WAIT_MOVE()	//カメラ移動待ち
	
		//自機の位置調整
		_OBJ_POS_CHANGE( N01R0502_SAGE1_01, 16, 0, 39, DIR_DOWN )
		_OBJ_POS_CHANGE( MMDL_ID_PLAYER, 16, 0, 40, DIR_UP )

		_END_EVENT_BGM_EX(BGM_FADE_VSHORT)

		_GET_ROM_VERSION( LWK_ROM )

		//可変OBJの確定
		IF $LWK_ROM == VERSION_WHITE THEN
			$OBJCHRWORK0 = SHIN_C	//シン
		ELSE
			$OBJCHRWORK0 = MU_C		//ム
		ENDIF

		_TRAINER_WIN()			//勝ち(1)ならトレーナー勝利処理へ
	ELSE
		_TRAINER_LOSE()			//負け(0)ならトレーナー敗北処理へ(ここでスクリプト終了します）
	ENDIF

	_TIME_WAIT( 30 )

	//ゲーチス：一歩下がる
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_keosu )
	_OBJ_ANIME_WAIT()

	//……どういうことだ？
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_sage1_08 , N01R0502_SAGE1_01,POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//アデク：１歩前へ
	_OBJ_ANIME( N01R0502_CHAMPION_01, anm_common_step )
	_OBJ_ANIME_WAIT()
	
	//さてＮよ……
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_champion_02 , N01R0502_CHAMPION_01,POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//ゲーチス：Ｎを見た後、自機を見て
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_l )
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_last1 )
	_OBJ_ANIME_WAIT()
	
	//……ふはは！　えいゆうに　なれぬ　ワタクシが
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_sage1_09 , N01R0502_SAGE1_01,POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//ライバル：一歩前へ
	_OBJ_ANIME( N01R0502_RIVAL_01, anm_common_step )
	_OBJ_ANIME_WAIT()
	
	//アデクさん　こいつの　はなしを　きいても
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_black_02 , N01R0502_RIVAL_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	//アデク：ライバルの方を見て
	_OBJ_ANIME( N01R0502_CHAMPION_01, anm_stay_r )
	_OBJ_ANIME_WAIT()
	
	//そうだな　ほんとうに　あわれなものよ
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_champion_05 , N01R0502_CHAMPION_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	//アデク：Ｎの方を見て
	_OBJ_ANIME( N01R0502_CHAMPION_01, anm_stay_u )
	_OBJ_ANIME_WAIT()

	//Ｎよ　いろいろ　おもうことが　あるだろう
	_BALLOONWIN_OBJMSG_WB( msg_n01r0502_champion_02w, msg_n01r0502_champion_02b, N01R0502_CHAMPION_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2392064,30 )
	_CAMERA_WAIT_MOVE()

	_TIME_WAIT( 20 )

	//Ｎ：アデクを見て
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_d )
	_OBJ_ANIME_WAIT()

	//だが　ぼくに　えいゆうの　しかくはない！
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_14 , N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//そうかあ？
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_champion_03 , N01R0502_CHAMPION_01, POS_DEFAULT )
	_MSGWIN_CLOSE()

	//首ふりアニメ後
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_kubi )
	_OBJ_ANIME_WAIT()
	
	//わかったような　ことを
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_15 , N01R0502_BOSS_01, POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//Ｎよ……　おたがい　りかい　しあえなくとも
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_champion_04 , N01R0502_CHAMPION_01, POS_DEFAULT )
	_MSGWIN_CLOSE()
	
	//ライバル・ゲーチス：画面外へ
	_OBJ_ANIME( N01R0502_RIVAL_01, anm_rival_tsureteku1 )
	_OBJ_ANIME( N01R0502_CHAMPION_01, anm_champion_tsureteku1 )
	_OBJ_ANIME_WAIT()
	
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_tsureteku1 )
	_OBJ_ANIME_WAIT()

	//無音にする
	_START_EVENT_BGM_EX( SEQ_BGM_SILENCE_DUNGEON, BGM_FADE_MIDDLE )

	_OBJ_ANIME( N01R0502_RIVAL_01, anm_rival_tsureteku2 )
	_OBJ_ANIME( N01R0502_CHAMPION_01, anm_champion_tsureteku2 )
	_OBJ_ANIME( N01R0502_SAGE1_01, anm_gcis_tsureteku2 )
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_tsureteku2 )
	_OBJ_ANIME_WAIT()

	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_nayamu )
	_OBJ_ANIME_WAIT()
	
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_kubi )
	_OBJ_ANIME_WAIT()
	
	_TIME_WAIT( 16 )

	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,0,2654208,30 )
	
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_nayamu1 )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()

	_TIME_WAIT(30)

	_OBJ_ANIME( MMDL_ID_PLAYER, anm_stay_r )
	_OBJ_ANIME_WAIT()

	//イベント曲再生
	_START_EVENT_BGM( SEQ_BGM_E_LAST )

	//ちょっといいかな　
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_20 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	_TIME_WAIT(20)

	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_ayumi0 )
	_OBJ_ANIME_WAIT()
	
	_TIME_WAIT( 45 )

	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,65551,1736704,220 )

	//自機・N：上に移動
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_ayumi )
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_ayumi )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()

	_TIME_WAIT( 30 )

	_OBJ_ANIME( MMDL_ID_PLAYER, anm_dir_r )
	_OBJ_ANIME_WAIT()

	//キミとはじめて　であった
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_21 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	//Ｎ：自機の方を見る
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_l )
	_OBJ_ANIME_WAIT()
	
	//なぜなら　あの　ポケモンは
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_22 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	_TIME_WAIT( 30 )

	//カメラ操作　Ｎの位置にカメラを合わせる
	_CAMERA_MOVE( 9688,0,970752,1081344,131103,1212416,130 )

	//Ｎ：もうちょい歩く・自機の方を見る
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_ayumi1 )
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_ayumi1 )
	_OBJ_ANIME_WAIT()
	
	_TIME_WAIT( 30 )
	
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_stay_r )
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_l )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()

	_TIME_WAIT( 30 )

	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_d )
	_OBJ_ANIME_WAIT()
	
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_kubi )
	_OBJ_ANIME_WAIT()

	//ボクには　りかい　できなかった
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_23 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	_TIME_WAIT( 30 )

	//Ｎ：自機の方を見る
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_l )
	_OBJ_ANIME_WAIT()
	
	//それからも　たびを　つづけるほどに
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_24 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	_CAMERA_MOVE( 9688,0,970752,1081344,196655,819200,60 )
	
	//Ｎ：移動後・自機の方を見る
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_last )
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_last )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()

	_TIME_WAIT( 30 )

	//ポケモンのことしか
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_25 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	_CAMERA_MOVE( 9688,0,970752,1081344,196655,573440,30 )

	//Ｎ：飛び降り地点まで移動
	_OBJ_ANIME( N01R0502_BOSS_01, anm_n_lastscene )
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_player_lastscene1 )
	_OBJ_ANIME_WAIT()
	
	_CAMERA_WAIT_MOVE()
	
	_TIME_WAIT( 20 )
	
	//さて　チャンピオンは　こんな　ボクを
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_16 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	//========================================/
	
	//X.16 Y.3 Z.7にモンスターボールを投げる演出
	_CALL ball_out	
	
	//========================================/

	//Ｎ：自機を見る
	_OBJ_ANIME( N01R0502_BOSS_01, anm_stay_d )
	_OBJ_ANIME_WAIT()

	//ポケモンのことしか
	_PLAYER_NAME(0)
	_BALLOONWIN_OBJMSG_POS( msg_n01r0502_boss_17 , N01R0502_BOSS_01,POS_DEFAULT )
	_MSGWIN_CLOSE()

	_TIME_WAIT( 5 )

	//Ｎのアップ絵表示  ※プレーンウィンドウを出すたびにアニメのリクエストをしましょう
	_START_FACEUP( FLD_FACEUP_BG_CATSLE2, FLD_FACEUP_CHAR_BOSS, TRUE )

	//はいと　答えた回数でメッセージ分岐
{
	_GET_ROM_VERSION( LWK_ROM )
		//ホワイトバージョンでかつ
		IF $LWK_ROM == VERSION_WHITE THEN
			
			//電気石の洞穴ではいを選択した場合
			IF FLAG_ON( FE_N_LASTMESSAGE ) THEN
				_START_FACEUP_ANM() //顔アップの口パク目パチ開始
				_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_last_01 )
				_PLAINWIN_CLOSE()
			
			//いいえを選択した場合
			ELSE
				_START_FACEUP_ANM() //顔アップの口パク目パチ開始
				_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_last_02 )
				_PLAINWIN_CLOSE()
			
			ENDIF

		ELSE
		
			//電気石の洞穴ではいを選択した場合
			IF FLAG_ON( FE_N_LASTMESSAGE ) THEN
				_START_FACEUP_ANM() //顔アップの口パク目パチ開始
				_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_last_03 )
				_PLAINWIN_CLOSE()
			
			//いいえを選択した場合
			ELSE
				_START_FACEUP_ANM() //顔アップの口パク目パチ開始
				_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_last_04 )
				_PLAINWIN_CLOSE()
			
			ENDIF
		
		ENDIF
}	
	//無音にする
	_START_EVENT_BGM_SILENT ( 160 )
	
	_TIME_WAIT( 30 )
	
	_START_FACEUP_ANM() //顔アップの口パク目パチ開始
	_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_last_05 )
	_PLAINWIN_CLOSE()

	_TIME_WAIT( 30 )

	_START_FACEUP_ANM() //顔アップの口パク目パチ開始
	_PLAINWIN_MSG_DOWN( msg_n01r0502_boss_last_06 )
	
	_SE_PLAY(SEQ_SE_END_01)
	
	_TIME_WAIT( 8 )
	
	//Ｎのアップ絵終了
	_CAMERA_END()
	_END_FACEUP()
	_PLAINWIN_CLOSE()
	
	//BGMチェンジでの環境SEポーズ状態をCLEAR
	//謁見の間では環境SEがないので、ここでクリアしても実際のプレイでは何も問題ありません。アッパーで環境SEが追加されたら要確認。
	_CLEAR_ENVSE_EVENT_BGMPLAY_PAUSE()
	
	//ゲームクリア
	_GOTO_GAMECLEAR_DEMO( 0 )
	//========================================/
	
	//$WK_SCENE_N01R0502を６にして終了
	$WK_SCENE_N01R0502 = 6

	//========================================/

_RET

//--------------------------------------------------------------------
//	Ｎ：lastbtl5用アニメ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_n_lastbtl5
	_ANIME_DATA	AC_WALK_U_8F,4
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_dir_u
	_ANIME_DATA	AC_DIR_U,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_dir_d
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_dir_r
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_dir_l
	_ANIME_DATA	AC_DIR_L,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_wait_come2
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	AC_MARK_GYOE,1
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_come
	_ANIME_DATA	AC_WALK_U_4F,5
	_ANIME_DATA	AC_WALK_U_16F,3
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_gcis_come2
	_ANIME_DATA	AC_WALK_R_16F,2
	_ANIME_DATA	AC_WALK_U_16F,2
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_come2a
	_ANIME_DATA	AC_WALK_U_16F,3
	_ANIME_DATA	AC_WALK_L_16F,1
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_look1
	_ANIME_DATA	AC_WAIT_16F,2
	_ANIME_DATA	AC_DIR_U,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_look1
	_ANIME_DATA	AC_WAIT_16F,3
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_come3
	_ANIME_DATA	AC_WALK_D_16F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_come4
	_ANIME_DATA	AC_WALK_L_16F,2
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_come5
	_ANIME_DATA	AC_WALK_R_16F,1
	_ANIME_DATA	AC_WALK_D_16F,1
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_rival_come
	_ANIME_DATA	AC_WALK_U_8F,4
	_ANIME_DATA	AC_WALK_U_16F,5
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_STAY_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_chanpion_come
	_ANIME_DATA	AC_WALK_U_8F,4
	_ANIME_DATA	AC_WALK_U_16F,5
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_keosu
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_U_16F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_keosu
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_D_4F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_rival_tsureteku1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_rival_tsureteku2
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_WALK_D_8F,10
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_tsureteku1
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	AC_STAY_WALK_R_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_tsureteku2
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_ANM_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_D_8F,10
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_champion_tsureteku1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_STAY_WALK_R_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_champion_tsureteku2
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_WALK_D_8F,10
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_tsureteku2
	_ANIME_DATA	AC_WALK_L_8F,2
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_champion_ayumi
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_ayumi0
	_ANIME_DATA	AC_WALK_R_16F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_ayumi
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_WALK_R_16F,1
	_ANIME_DATA	AC_WALK_U_16F,14
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_ayumi
	_ANIME_DATA	AC_WALK_R_16F,1
	_ANIME_DATA	AC_WALK_U_16F,14
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_ayumi1
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_WALK_U_16F,8
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_ayumi1
	_ANIME_DATA	AC_WALK_U_16F,8
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_last
	_ANIME_DATA	AC_WALK_U_16F,2
	_ANIME_DATA	AC_WALK_U_8F,3
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_last
	_ANIME_DATA	AC_WAIT_16F,1
	_ANIME_DATA	AC_WALK_U_16F,3
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_lastscene
	_ANIME_DATA	AC_WALK_U_16F,2
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_lastscene1
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	AC_WALK_U_16F,1
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0
	
_ANIME_LABEL	anm_package_lastscene
	_ANIME_DATA	AC_WALK_D_2F,15
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_player_lastscene
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_champion_lastscene
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//		100427	アニメ修正分
//--------------------------------------------------------------------
_ANIME_LABEL	anm_common_step
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gcis_last1
	_ANIME_DATA	AC_STAY_WALK_U_16F,1
	_ANIME_DATA	AC_WAIT_16F,2
	_ANIME_DATA	AC_STAY_WALK_D_16F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_nayamu
	_ANIME_DATA	AC_STAY_WALK_L_16F,1
	_ANIME_DATA	AC_WAIT_16F,2
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_n_nayamu1
	_ANIME_DATA	AC_WALK_D_8F,4
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0


/************************************************************/
//Ｎの伝説ポケモンの鳴き声
/************************************************************/
sub_voice_play_n_legend:
	  _GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_VOICE_PLAY( MONSNO_650, 0 )
		ELSE
			_VOICE_PLAY( MONSNO_651, 0 )
		ENDIF
    _RET

/************************************************************/
//ストーンから生まれた伝説ポケモンの鳴き声
/************************************************************/
sub_voice_play_mine_legend:
	  _GET_ROM_VERSION( LWK_ROM )
		IF $LWK_ROM == VERSION_WHITE THEN
			_VOICE_PLAY( MONSNO_651, 0 )
		ELSE
			_VOICE_PLAY( MONSNO_650, 0 )
		ENDIF
    _RET

/************************************************************/
//  伝説ポケモンを（なるべく）手持ちに入れる処理
/************************************************************/
sub_add_legend:
  _CRIMAX_DEMO_COMMAND( SCR_CRIMAX_CMD_TEMOTI_CHECK, SCWK_ANSWER )
  IF $SCWK_ANSWER == TRUE THEN
    _CRIMAX_DEMO_COMMAND( SCR_CRIMAX_CMD_SORT, SCWK_ANSWER )
  ELSE
    _CALL sub_legend_add_loop
  ENDIF
  _RET


sub_legend_add_loop:
{
  DEFINE_LOCAL  LWK_SELPOS
  DEFINE_LOCAL  LWK_LOOP
  DEFINE_LOCAL  LWK_LOOP_END
  DEFINE_LOCAL  LWK_GET_POKE
	_GET_ROM_VERSION( LWK_ROM )
  IF $LWK_ROM == VERSION_WHITE THEN
      $LWK_GET_POKE = MONSNO_651
  ELSE
      $LWK_GET_POKE = MONSNO_650
  ENDIF
  $LWK_LOOP_END = FALSE
  $LWK_LOOP = 0

  WHILE $LWK_LOOP_END == FALSE

      SWITCH $LWK_LOOP
      CASE  0 THEN
          //てもちに　くわえますか？
          _MONS_NAME( 1, LWK_GET_POKE )
          _SYSWIN_MSG( msg_n01r0502_get_01, POS_DOWN )
          _YES_NO_WIN( SCWK_ANSWER )
          IF $SCWK_ANSWER == SCR_YES THEN
              $LWK_LOOP = 1   //ポケモン選択へ
          ELSE
              $LWK_LOOP = 3   //キャンセル確認へ
          ENDIF

      CASE  1 THEN
          //ではどのポケモンを　おくりかえしますか？
          _SYSWIN_MSG( msg_n01r0502_get_03, POS_DOWN )
          _SYSWIN_CLOSE()
          _SELECT_TEMOTI_POKE( SCWK_ANSWER, LWK_SELPOS, 0 )
          IF $SCWK_ANSWER == TRUE THEN
              $LWK_LOOP = 2   //送り返し確認へ
          ELSE
              $LWK_LOOP = 3   //キャンセル確認へ
          ENDIF

      CASE  2 THEN
          //その〜を送り返していいですか？
          _TEMOTI_NICK_NAME( 2, LWK_SELPOS )
          _SYSWIN_MSG( msg_n01r0502_get_04, POS_DOWN )
          _YES_NO_WIN( SCWK_ANSWER )
          IF $SCWK_ANSWER == SCR_YES THEN
              //ボックスの伝説ポケと選んだ手持ちを交換
              _CRIMAX_DEMO_COMMAND( SCR_CRIMAX_CMD_GET_FROM_BOX, LWK_SELPOS )
              //〜を　てもちにくわえた！
              _MONS_NAME( 1, LWK_GET_POKE )
              _SYSWIN_MSG( msg_n01r0502_get_05, POS_DOWN )
              _AB_KEYWAIT_MARK()
              _SYSWIN_CLOSE()
              $LWK_LOOP_END = TRUE  //取得して完了
          ELSE
              $LWK_LOOP = 0     //取得確認へ
          ENDIF
      CASE  3 THEN
          //てもちに　くわえなくていいですか？
          _MONS_NAME( 1, LWK_GET_POKE )
          _SYSWIN_MSG( msg_n01r0502_get_02, POS_DOWN )
          _YES_NO_WIN( SCWK_ANSWER )
          IF $SCWK_ANSWER == SCR_YES THEN
              _SYSWIN_CLOSE()
              $LWK_LOOP_END = TRUE  //取得せずに完了
          ELSE
              $LWK_LOOP = 1     //ポケモン選択へ
          ENDIF

      ENDSWITCH

  ENDWHILE

  _RET
}

/**************************************************************/
/*    手持ちとボックスが一杯か？チェック  */
/**************************************************************/
sub_empty_check:
{
  DEFINE_LOCAL  LWK_BOX_COUNT
  DEFINE_LOCAL  LWK_TEMTOTI_COUNT
  _GET_BOX_POKE_COUNT( LWK_BOX_COUNT, POKECOUNT_MODE_EMPTY )
  _DEBUG_PRINT_WK( LWK_BOX_COUNT )
  _GET_PARTY_POKE_COUNT( LWK_TEMTOTI_COUNT, POKECOUNT_MODE_EMPTY )
  _DEBUG_PRINT_WK( LWK_TEMTOTI_COUNT )
  IF $LWK_TEMTOTI_COUNT == 0 && $LWK_BOX_COUNT == 0 THEN
    $SCWK_ANSWER = TRUE
  ELSE
    $SCWK_ANSWER = FALSE
  ENDIF
  _DEBUG_PRINT_WK( SCWK_ANSWER )
}
_RET

/**************************************************************/
/*		ボール投げる演出			  */
/**************************************************************/
ball_out:
  _LEG_MOVE_BALL( N01R0502_BOSS_01, 16, 5, 6, 10, 20 )
  _LEG_START_BALL_ANM( 16, 5, 6  )
  //ボール出現フレーム待ち
  _LEG_WAIT_BALL_POKE_APP()
  _WHITE_OUT()
  _DISP_FADE_END_CHECK()
  //ポケを表示
  //フラグリセット
  _FLAG_RESET( FV_N01R0502_LEGEND_01 )
  _OBJ_ADD( N01R0502_WKOBJCODE00_01 )
  _OBJ_POS_CHANGE( N01R0502_WKOBJCODE00_01, 16, 2, 7, DIR_DOWN )
	
  _OBJ_ANIME( N01R0502_WKOBJCODE00_01, anm_legend_last )

  _WHITE_IN()
  _DISP_FADE_END_CHECK()
  _LEG_WAIT_BALL_ANM()
  _OBJ_ANIME_WAIT()
_RET

/**************************************************************/
/*		ゲーチス	話しかけ（負けた場合のもの）			  */
/**************************************************************/
EVENT_START		ev_n01r0502_sage1_01
_TALK_OBJ_START()

	_CALL ev_last

EVENT_END

/**************************************************************/
/*		RIVAL		N01R0502								  */
/**************************************************************/
EVENT_START		ev_n01r0502_rival_01
	//未使用ラベルです、本編中にこのメッセージが表示される事はありません。
	_EASY_BALLOONWIN_TALKOBJ_MSG( msg_n01r0502_rematch_black )
EVENT_END

/**************************************************************/
/*		CHAMP		N01R0502								  */
/**************************************************************/
EVENT_START		ev_n01r0502_champion_01
	//未使用ラベルです、本編中にこのメッセージが表示される事はありません。
	_EASY_BALLOONWIN_TALKOBJ_MSG( msg_n01r0502_rematch_champion )
EVENT_END
