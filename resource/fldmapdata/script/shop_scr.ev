//======================================================================
//                shop_scr.ev
//    ショップ関連スクリプト
//
//    スクリプトファイル：shop_scr用
//
//======================================================================

  .text

  .include  "scr_seq_def.h"
  .include  "msg_shop_scr.h"
  .include  "shop_scr_local.h"
  //.include  "wifi_club_scr.h"

//  .include  "../../../prog/include/system/timezone.h" //時間帯定義

//--------------------------------------------------------------
//               スクリプト本体
//--------------------------------------------------------------
//--------------------------------------------------------------
//               スクリプトテーブル
//--------------------------------------------------------------
_EVENT_DATA    ev_shop_counter
_EVENT_DATA_END

DEFINE_LOCAL  reg_return

{ //SHOP_MAIN

//==============================================================
/// 
///
///       ポケモンセンター　ショップ受付                   
///
///
//==============================================================
ev_shop_counter:
{
  _CALL sub_shop_main
}
_CHG_LOCAL_SCR

//==============================================================
//サブルーチン：フレンドリィショップメイン
//==============================================================
sub_shop_main:
{
  DEFINE_LOCAL  i_ret
  DEFINE_LOCAL  i_seq
  DEFINE_LOCAL  i_loop

  $i_loop = TRUE
  WHILE $i_loop == TRUE
    SWITCH $i_seq
    CASE SEQ_MENU THEN
      _CALL sub_shop_menu
      $i_seq = $reg_return
    
    CASE SEQ_BUY THEN
      _CALL sub_shop_menu
      $i_seq = $reg_return
    
    CASE SEQ_SELL THEN
      _CALL sub_shop_menu
      $i_seq = $reg_return

    CASE SEQ_EXIT THEN
      $i_loop = FALSE
    ENDSWITCH
  ENDWHILE
/*
  //C-Gear取得チェック
  IF FLAG_ON( FE_CGEAR_GET ) THEN
    _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_err01 ) //また後でお越しください
    _LAST_KEYWAIT()
    _BALLOONWIN_CLOSE()
    _RET
  ENDIF
 
  //ダメタマチェック
  _GET_PARTY_POKE_COUNT( i_ret, POKECOUNT_MODE_ONLY_DAME_EGG)
  IF $i_ret != 0 THEN
    _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_err02 ) //手持ちに連れて行けないポケモンがいます
    _LAST_KEYWAIT()
    _BALLOONWIN_CLOSE()
    _RET
  ENDIF

  _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_01 ) //Wi-Fiクラブへようこそ
  $i_seq = SEQ_MENU

  $i_loop = TRUE
  WHILE $i_loop == TRUE
    SWITCH  $i_seq
    CASE SEQ_MENU THEN //メニュー表示
      _CALL sub_club_counter_menu
      $i_seq = $reg_return

    CASE SEQ_CLUB_EXP THEN
      _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_07 ) //Wi-Fiクラブでは…
      $i_seq = SEQ_MENU

    CASE SEQ_CHECK_CONNECT THEN
      _CALL sub_club_counter_check_connect
      $i_seq = $reg_return

    CASE SEQ_CONNECT THEN
      _CALL sub_club_counter_connect
      $i_seq = $reg_return

    CASE SEQ_GOODBYE THEN
      _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_02 ) //それではまたお越しください
      _LAST_KEYWAIT()
      _BALLOONWIN_CLOSE()
      $i_loop = FALSE
    ENDSWITCH
  ENDWHILE
*/
}
_RET

//==============================================================
//サブルーチン：メニュー表示
//==============================================================
sub_shop_menu:
{
  DEFINE_LOCAL  i_ret

  //ようこそ
  
  //分岐・Wi-Fiクラブへいく・せつめいをきく・やめる
	_BMPMENU_INIT_EX( 1, 1, 0, 1, i_ret )
		
	_BMPMENU_MAKE_LIST( msg_shop_menu01_01, SEQ_BUY )	//かう
	_BMPMENU_MAKE_LIST( msg_shop_menu01_02, SEQ_SELL )	//うる
	_BMPMENU_MAKE_LIST( msg_shop_menu01_03, SEQ_EXIT )	//やめる
		
	//メニュー表示
	_BMPMENU_START()
//  _BALLOONWIN_CLOSE()

  $reg_return = $i_ret
}
_RET

/*
//==============================================================
//サブルーチン：Wi-Fiコネクトチェック
//==============================================================
sub_club_counter_check_connect:
{
  DEFINE_LOCAL  i_ret
  DEFINE_LOCAL  i_friend_num
  DEFINE_LOCAL  i_id_state

  //IDの状態チェック
  $i_id_state = 0

  //登録人数チェック
  $i_friend_num = 0

  IF $i_id_state == TRUE THEN
    IF $i_friend_num == 0 THEN
      _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_06 ) //友だちを登録していないと利用できません
      _BALLOONWIN_CLOSE()
      $reg_return = SEQ_GOODBYE
    ELSE
      $reg_return = SEQ_CONNECT
    ENDIF
    _RET
  ENDIF

  //仮IDを取得しますか？
  _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_05 ) //自分のコードだけでも受け取りますか？
  _YES_NO_WIN( i_ret )
  _BALLOONWIN_CLOSE()
  
  //『はい』
  IF $i_ret == 0 THEN
    $reg_return = SEQ_CONNECT
  ELSE
    $reg_return = SEQ_GOODBYE
  ENDIF
}
_RET

//==============================================================
//サブルーチン：Wi-Fiコネクト
//==============================================================
sub_club_counter_connect:
{
  DEFINE_LOCAL  i_ret
  DEFINE_LOCAL  i_friend_num
  DEFINE_LOCAL  i_id_state

  //Wi-Fi接続を開始しますか？
  _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_03 )
  _YES_NO_WIN( i_ret )
  _BALLOONWIN_CLOSE()

  IF $i_ret == 1 THEN
    $reg_return = SEQ_GOODBYE
    _RET
  ENDIF

  // レポートを書く
  _REPORT_EVENT_CALL( i_ret )
  // 書き込みに失敗
  IF $i_ret != SCR_REPORT_OK THEN
    $reg_return = SEQ_GOODBYE
    _RET
  ENDIF
  
  //接続　それではご案内します
  _BALLOONWIN_TALKOBJ_OPEN( msg_wifi_club_01_04 )
  _AB_KEYWAIT()
  _BALLOONWIN_CLOSE()

  $reg_return = SEQ_GOODBYE
}
_RET
*/

} //SHOP_MAIN_END
