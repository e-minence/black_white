
//======================================================================
//                t01r0102.ev
//
//    スクリプトファイル：t01r0102用
//
//======================================================================

  .text

  .include  "scr_seq_def.h"
  .include  "../../message/dst/script/msg_t01r0102.h"
  .include  "t01r0102.h"

//--------------------------------------------------------------
//               スクリプト本体
//--------------------------------------------------------------

//--------------------------------------------------------------
//               スクリプトテーブル
//--------------------------------------------------------------
//【仮】仮ラベル　アプリ完成後、ラベルごと消します。
_EVENT_DATA    ev_t01r0102_poke_get0
_EVENT_DATA    ev_t01r0102_poke_get1
_EVENT_DATA    ev_t01r0102_poke_get2

//ラベル名修正　斉藤マ091012
_EVENT_DATA    ev_bg_t01r0102_game_01
_EVENT_DATA    ev_bg_t01r0102_tv_01
_EVENT_DATA    ev_bg_t01r0102_pc_01
_EVENT_DATA    ev_bg_t01r0102_bed_01

//ここより下、斉藤マ作成
_EVENT_DATA    ev_scene_t01r0102_gamestart		//ゲーム開始時のイベント
_EVENT_DATA    ev_pos_t01r0102_stopper			//ポケモン３匹入手イベントのライバルストッパー
_EVENT_DATA    ev_t01r0102_rival_01
_EVENT_DATA    ev_t01r0102_support_01


_EVENT_DATA_END


/************************************************************/
/*			SCENE_CHANGE_LABEL　ゲーム開始イベント			*/
/************************************************************/
EVENT_START	ev_scene_t01r0102_gamestart

	//手紙を読む
	_PLAYER_NAME( 0 )		//主人公名取得
	_SPWIN_MSG( msg_t01r0102_letter_01, 4, 2, SPWIN_LETTER )
	_MSGWIN_CLOSE()

	//ライバル：一歩前へ
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_gamestart_rival_move_01 )
	_OBJ_ANIME_WAIT()

	//ライバル会話：博士がポケモンくれるって？
	_PLAYER_NAME( 0 )		//主人公名取得
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_01 , T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//サポート：表示
	_FLAG_RESET( FV_T01R0102_SUPPORT )
	_OBJ_ADD( T01R0102_SUPPORT_01 )

	//階段ＳＥ
	_SE_PLAY(SEQ_SE_KAIDAN)
	_SE_WAIT()

	//サポート：階段を上ってくる
	_OBJ_ANIME( T01R0102_SUPPORT_01, anm_gamestart_support_move_01 )
	_OBJ_ANIME_WAIT()

	//サポート会話：ごめんね　遅くなっちゃった
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_01 , T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()

	//主人公・ライバル：サポートを見る
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_gamestart_player_look_01 )
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_gamestart_rival_look_01 )
	_OBJ_ANIME_WAIT()

	//サポート：ボールの横へ
	_OBJ_ANIME( T01R0102_SUPPORT_01, anm_gamestart_support_move_02 )
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_gamestart_rival_look_02 )

	//ライバル会話：時間まもれよー
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_02 , T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//【仮】演出実験
	_OBJ_ANIME_WAIT()

	//サポート会話：はーい　ごめんなさい
	_PLAYER_NAME( 0 )		//主人公名取得
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_02, T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()

	//ライバル：ボールを見る
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_gamestart_rival_look_03 )
	_OBJ_ANIME_WAIT()

	//ライバル会話：ボールを調べなよ
	_PLAYER_NAME( 0 )		//主人公名取得
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_03, T01R0102_RIVAL_01 )
	_LAST_KEYWAIT()
	_BALLOONWIN_CLOSE()

//================フラグ操作==================//

	//シーンチェンジラベル無効
	$WK_SCENE_T01R0102 = 1

//============================================//

EVENT_END

//--------------------------------------------------------------------
//ライバル：一歩前へ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_gamestart_rival_move_01
	_ANIME_DATA	AC_WALK_D_8F,1
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//サポート：階段を上ってくる
//--------------------------------------------------------------------
_ANIME_LABEL	anm_gamestart_support_move_01
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//主人公・ライバル：サポートを見る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_gamestart_player_look_01
	_ANIME_DATA	AC_STAY_WALK_R_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_gamestart_rival_look_01
	_ANIME_DATA	AC_WALK_U_8F,1
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//サポート：ボールの横へ
//--------------------------------------------------------------------
_ANIME_LABEL	anm_gamestart_support_move_02
	_ANIME_DATA	AC_WALK_D_8F,4
	_ANIME_DATA	AC_WALK_L_8F,2
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ライバル：サポートを見る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_gamestart_rival_look_02
	_ANIME_DATA	AC_WAIT_8F,5
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ライバル：ボールを見る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_gamestart_rival_look_03
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0


/************************************************************/
/*				階段手前：ストッパーposイベント				*/
/************************************************************/
EVENT_START	ev_pos_t01r0102_stopper
	//ライバル：右を向く
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_dir_r )
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_dir_l )
	_OBJ_ANIME_WAIT()

	//ライバル会話：まず選んでくれないと！
	_PLAYER_NAME( 0 )		//主人公名取得
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_04 , T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//主人公：一歩戻る
	_OBJ_ANIME( MMDL_ID_PLAYER, anm_posstop_player_back_01 )
	//ライバル：左を向く
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_dir_l )
	_OBJ_ANIME_WAIT()

EVENT_END

//--------------------------------------------------------------------
//共通：方向転換
//--------------------------------------------------------------------
_ANIME_LABEL	anm_dir_l
	_ANIME_DATA	AC_STAY_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

_ANIME_LABEL	anm_dir_r
	_ANIME_DATA	AC_STAY_WALK_R_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//主人公：一歩戻る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_posstop_player_back_01
	_ANIME_DATA	AC_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0


/************************************************************/
/*						ライバル							*/
/************************************************************/
EVENT_START	ev_t01r0102_rival_01
	_TALK_OBJ_START()

	//シナリオ進行状況で分岐
	IF $WK_SCENE_T01R0102 == 1 THEN

		//ポケモン３匹選択中の会話

		//まず選んでくれないと…
		_PLAYER_NAME( 0 )		//主人公名取得
		_BALLOONWIN_TALKOBJ_MSG( msg_t01r0102_black_04 )
		_BALLOONWIN_CLOSE()

		//ライバル：ボールを見る
		_OBJ_ANIME( T01R0102_RIVAL_01, anm_dir_l )
		_OBJ_ANIME_WAIT()

	ELSE

		//【仮】ポケモン入手後、戦闘イベント（戦闘前後でさらに分岐）現状は戦闘を強制にしているため話しかけられない


	ENDIF

EVENT_END


/************************************************************/
/*						サポート							*/
/************************************************************/
EVENT_START	ev_t01r0102_support_01
	_TALK_OBJ_START()

	//シナリオ進行状況で分岐
	IF $WK_SCENE_T01R0102 == 1 THEN

		//ポケモン３匹選択中の会話

		//どのポケモンにするか迷っちゃうね
		_BALLOONWIN_TALKOBJ_MSG( msg_t01r0102_white_03 )
		_BALLOONWIN_CLOSE()

		//サポート：ボールを見る
		_OBJ_ANIME( T01R0102_SUPPORT_01, anm_dir_l )
		_OBJ_ANIME_WAIT()

	ELSE

		//【仮】ポケモン入手後、戦闘イベント（戦闘前後でさらに分岐）現状は戦闘を強制にしているため話しかけられない


	ENDIF

EVENT_END


/************************************************************/
/*					初期３匹選択イベント					*/
/************************************************************/
//【仮】最初の３匹選択　炎タイプ
EVENT_START   ev_t01r0102_poke_get0

	_SYSWIN_MSG_DOWN(msg_t01r0102_ball1_fire_01)
	_YES_NO_WIN( SCWK_ANSWER )
	_SYSWIN_CLOSE()

	IF $SCWK_ANSWER == 0 THEN
		//炎タイプを選んだ
		$WK_SYS_FIRST_POKETYPE = FIRST_POKETYPE_HONOO
		$SCWK_TEMP0 = MONSNO_HOTTON		//追加ポケモンのナンバーを格納

		_CALL t01r0102_poke_get_yes
	ENDIF
EVENT_END

//【仮】最初の３匹選択　草タイプ
EVENT_START   ev_t01r0102_poke_get1

	_SYSWIN_MSG_DOWN(msg_t01r0102_ball1_grass_01)
	_YES_NO_WIN( SCWK_ANSWER )
	_SYSWIN_CLOSE()

	IF $SCWK_ANSWER == 0 THEN
		//草タイプを選んだ
		$WK_SYS_FIRST_POKETYPE = FIRST_POKETYPE_KUSA
		$SCWK_TEMP0 = MONSNO_KUSAHEBI	//追加ポケモンのナンバーを格納

		_CALL t01r0102_poke_get_yes
	ENDIF
EVENT_END

//【仮】最初の３匹選択　水タイプ
EVENT_START   ev_t01r0102_poke_get2
  
	_SYSWIN_MSG_DOWN(msg_t01r0102_ball1_water_01)
	_YES_NO_WIN( SCWK_ANSWER )
	_SYSWIN_CLOSE()

	IF $SCWK_ANSWER == 0 THEN
		//水タイプを選んだ
		$WK_SYS_FIRST_POKETYPE = FIRST_POKETYPE_MIZU
		$SCWK_TEMP0 = MONSNO_SUIKKO		//追加ポケモンのナンバーを格納

		_CALL t01r0102_poke_get_yes
	ENDIF
EVENT_END


//共通、ポケモン入手メッセージ
t01r0102_poke_get_yes:

	//==========ポケモン入手処理==============//

	_PLAYER_NAME( 0 ) //プレイヤー名を反映
	_SYSWIN_MSG_DOWN(msg_t01r0102_ball_get_01)

	//ME鳴らす
	_ME_PLAY( SEQ_ME_POKEGET )
	_ME_WAIT()

	//ポケモン追加　【仮】追加ポケモンのラベルが仮。アプリ完成後このラベル自体が削除予定。
	_ADD_POKEMON_TO_PARTY( SCWK_ANSWER, SCWK_TEMP0, 0, 0, 5, 0 )

	_SYSWIN_CLOSE()

	//初期３体入手フラグ
	_FLAG_SET( SYS_FLAG_FIRST_POKE_GET )

	//========================================//

	//【仮】ボールに近づく演出が未作成091002
	//専用アプリになるか分からないため

	//サポート会話：あたし　このポケモン！
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_04,T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()

	//サポート：上を向く
	_OBJ_ANIME( T01R0102_SUPPORT_01,anm_pokeget_support_look_01 )
	_OBJ_ANIME_WAIT()

	//ライバル：下を向く
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_pokeget_rival_look_01 )
	_OBJ_ANIME_WAIT()

	//ライバル会話：まあ　いいけどさ
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_05, T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//ブラックアウト
	_BLACK_OUT()
	_DISP_FADE_END_CHECK()

	//ボール削除
	_OBJ_DEL( T01R0102_BALL1 )
	_OBJ_DEL( T01R0102_BALL2 )
	_OBJ_DEL( T01R0102_BALL3 )

//========================================//

	//ボールのバニッシュフラグをセット（アプリ完成すれば不要かも）
	_FLAG_SET( FV_T01R0102_BALL00 )
	_FLAG_SET( FV_T01R0102_BALL01 )
	_FLAG_SET( FV_T01R0102_BALL02 )

//========================================//

	//ブラックイン
	_BLACK_IN()
	_DISP_FADE_END_CHECK()

	//サポート：左を向く
	_OBJ_ANIME( T01R0102_SUPPORT_01, anm_dir_l )
	_OBJ_ANIME_WAIT()

	//サポート曲再生。演出をつめる。サポートは問題ないが、ライバルＢＧＭの鳴らすタイミングが難しい。
	_START_EVENT_BGM( SEQ_BGM_E_SUPPORT )

	//サポート会話：勝負しましょ！
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_05, T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()

	//ライバル：その場歩き
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_pokeget_rival_look_01 )
	_OBJ_ANIME_WAIT()

	//ライバル会話：家の中だぞ？
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_06, T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//サポート会話：だいじょーぶだって
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_06 , T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()

	//【保留】はい・いいえ選択：処理が複雑になるため保留091002
//	_YES_NO_WIN( SCWK_ANSWER )
//	IF $SCWK_ANSWER == VAL THEN (テンプレ）ENDIF

	//サポート戦闘呼び出し　最初の３匹によって分岐　負けてもシナリオ進行
	IF $WK_SYS_FIRST_POKETYPE == FIRST_POKETYPE_KUSA THEN
		//初期３匹で草タイプを選択
		_TRAINER_BTL_SP_SET( TRID_SUPPORT_01, 0, SCR_BATTLE_MODE_NOLOSE )
	ELSIF $WK_SYS_FIRST_POKETYPE == FIRST_POKETYPE_HONOO THEN
		//初期３匹で炎タイプを選択
		_TRAINER_BTL_SP_SET( TRID_SUPPORT_02, 0, SCR_BATTLE_MODE_NOLOSE )
	ELSE
		//初期３匹で水タイプを選択
		_TRAINER_BTL_SP_SET( TRID_SUPPORT_03, 0, SCR_BATTLE_MODE_NOLOSE )
	ENDIF

	//【仮】勝敗によるメッセージ分岐
	//サポート会話：つよいねー
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_11, T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()
	
	
	//ライバル曲再生
	_START_EVENT_BGM( SEQ_BGM_E_RIVAL )
	
	//手持ちの残りHPで分岐
	_CHECK_TEMOTI_HP( SCWK_ANSWER, 0 )		//ＨＰをチェック（必ず手持ちの先頭にいるはずなので 0 を指定）
	IF $SCWK_ANSWER == TRUE THEN
		//ＨＰが満タンのとき

		//ライバル会話：ポケモンのＨＰを減らすことなく…
		_BALLOONWIN_OBJMSG( msg_t01r0102_black_08 , T01R0102_RIVAL_01 )
		_BALLOONWIN_CLOSE()

	ELSE
		//ＨＰが減っているとき

		//ライバル会話：これを　つかってやるよ
		_BALLOONWIN_OBJMSG( msg_t01r0102_black_09 , T01R0102_RIVAL_01 )
		_BALLOONWIN_CLOSE()

		//回復処理
		_TEMOTI_POKEMON_KAIFUKU()

	ENDIF

	//ライバル会話：で……　オレも相手してよ！
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_10 , T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//ライバル戦呼び出し　最初の３匹によって分岐　負けてもシナリオ進行
	IF $WK_SYS_FIRST_POKETYPE == FIRST_POKETYPE_KUSA THEN
		//初期３匹で草タイプを選択
		_TRAINER_BTL_SP_SET( TRID_RIVAL_01, 0, SCR_BATTLE_MODE_NOLOSE )
	ELSIF $WK_SYS_FIRST_POKETYPE == FIRST_POKETYPE_HONOO THEN
		//初期３匹で炎タイプを選択
		_TRAINER_BTL_SP_SET( TRID_RIVAL_02, 0, SCR_BATTLE_MODE_NOLOSE )
	ELSE
		//初期３匹で水タイプを選択
		_TRAINER_BTL_SP_SET( TRID_RIVAL_03, 0, SCR_BATTLE_MODE_NOLOSE )
	ENDIF

	//全滅する可能性もあるので回復させる
	_TEMOTI_POKEMON_KAIFUKU()		//回復処理

	//ライバル会話：フゥ　これがポケモン勝負か！
	_BALLOONWIN_OBJMSG( msg_t01r0102_black_11 , T01R0102_RIVAL_01 )
	_BALLOONWIN_CLOSE()

	//ライバル：去る
	_OBJ_ANIME( T01R0102_RIVAL_01, anm_pokeget_rival_goaway_01 )
	_OBJ_ANIME_WAIT()

	//ライバル：削除
	_OBJ_DEL( T01R0102_RIVAL_01 )
	_SE_PLAY(SEQ_SE_KAIDAN)		//階段ＳＥ
	_SE_WAIT()

	//サポート会話：あたし　家に戻るね
	_BALLOONWIN_OBJMSG( msg_t01r0102_white_12 , T01R0102_SUPPORT_01 )
	_BALLOONWIN_CLOSE()

	//サポート：去る
	_OBJ_ANIME( T01R0102_SUPPORT_01, anm_pokeget_support_goaway_01 )
	_OBJ_ANIME_WAIT()

	//サポート削除
	_OBJ_DEL( T01R0102_SUPPORT_01 )	
	_SE_PLAY(SEQ_SE_KAIDAN)		//階段ＳＥ
	_SE_WAIT()

//=======================フラグ操作=======================//

	//ライバル非表示
	_FLAG_SET( FV_T01R0102_RIVAL )
	//サポート非表示
	_FLAG_SET( FV_T01R0102_SUPPORT )

	//ストッパーpos無効
	$WK_SCENE_T01R0102 = 2

//=======================================================//



	_RET

//--------------------------------------------------------------------
//サポート：ライバルを見る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_pokeget_support_look_01
	_ANIME_DATA	AC_STAY_WALK_U_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ライバル：サポートを見る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_pokeget_rival_look_01
	_ANIME_DATA	AC_STAY_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ライバル：去る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_pokeget_rival_goaway_01
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	AC_WALK_R_8F,3
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//サポート：去る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_pokeget_support_goaway_01
	_ANIME_DATA	AC_WALK_U_8F,4
	_ANIME_DATA	AC_WALK_R_8F,3
	_ANIME_DATA	ACMD_END,0


/**************************************************************/
/*  T01R0102 GAME MACHINEのBG用イベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_t01r0102_game_01
	_TALK_START_SE_PLAY()
	
	_PLAINWIN_MSG_DOWN( msg_t01r0102_game_01 )
	_LAST_KEYWAIT()
	_MSGWIN_CLOSE()
EVENT_END

/**************************************************************/
/*  T01R0102 TVのBG用イベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_t01r0102_tv_01
	_TALK_START_SE_PLAY()
	
	_PLAINWIN_MSG_DOWN( msg_t01r0102_tv_01 )
	_LAST_KEYWAIT()
	_MSGWIN_CLOSE()

EVENT_END

/**************************************************************/
/*  T01R0102 PCのBG用イベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_t01r0102_pc_01
	_TALK_START_SE_PLAY()
	
	_PLAYER_NAME( 0 )
	_PLAINWIN_MSG_DOWN( msg_t01r0102_pc_01 )
	_LAST_KEYWAIT()
	_MSGWIN_CLOSE()

EVENT_END

/**************************************************************/
/*  T01R0102 BEDのBG用イベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_t01r0102_bed_01
	_TALK_START_SE_PLAY()
	
	_PLAINWIN_MSG_DOWN( msg_t01r0102_bed_01 )
	_LAST_KEYWAIT()
	_MSGWIN_CLOSE()

EVENT_END


