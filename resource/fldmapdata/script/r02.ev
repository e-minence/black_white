//======================================================================
//                r02
//======================================================================

  .text

  .include  "scr_seq_def.h"
  .include  "../../../prog/include/msg/script/msg_r02.h"
  .include  "r02.h"

//--------------------------------------------------------------
//               スクリプト本体
//--------------------------------------------------------------

//--------------------------------------------------------------
//               スクリプトテーブル
//--------------------------------------------------------------
_EVENT_DATA    ev_pos_r02_mama_01

_EVENT_DATA    ev_r02_boy2_01
_EVENT_DATA    ev_r02_girl2_01

_EVENT_DATA	   ev_bg_r02_board1_01
_EVENT_DATA	   ev_bg_r02_board2_01
_EVENT_DATA	   ev_bg_r02_board3_01
_EVENT_DATA		ev_r02_boy1_01
_EVENT_DATA_END

//------------------------------注意--------------------------------//
//																	//
//	FH_16を使用しました。同マップ内の使用を禁止します。				//
//				FH_16⇒段差説明イベント								//
//																	//
//------------------------------------------------------------------//
/**************************************************************/
//ev_r02_flag_change:
//  _END

/**************************************************************/
/*段差降りパフォーマンスの少年                                */
/**************************************************************/
EVENT_START   ev_r02_boy1_01
  _TALK_OBJ_START()
	
	IF FLAG_OFF( FH_16) THEN
	
		_BALLOONWIN_OBJMSG(msg_r02_boy2a_01,R02_BOY1_01)
		_YES_NO_WIN( SCWK_ANSWER )
		_BALLOONWIN_CLOSE() //会話ウィンドウを閉じます
	
		IF $SCWK_ANSWER == 0 THEN
			_FLAG_SET(FH_16)
			_BALLOONWIN_OBJMSG(msg_r02_boy2a_02,R02_BOY1_01)
			_LAST_KEYWAIT()
			_BALLOONWIN_CLOSE()
			//段差を降りるアニメ+段差を降りるSE
			_SE_PLAY( SEQ_SE_DANSA )
			_OBJ_ANIME( R02_BOY1_01,test01anime )
			_OBJ_ANIME_WAIT()
			_SE_WAIT()

			_TURN_HERO_SITE()
			_EASY_BALLOONWIN_TALKOBJ_MSG(msg_r02_boy2a_03)

			
		ELSE
			_EASY_BALLOONWIN_TALKOBJ_MSG(msg_r02_boy2a_04)
		ENDIF

	ELSE
			_EASY_BALLOONWIN_TALKOBJ_MSG(msg_r02_boy2a_03)
	ENDIF
EVENT_END

//--------------------------------------------------------------------
//段差説明少年:段差を飛び降りる                       
//--------------------------------------------------------------------
	_ANIME_LABEL test01anime
	_ANIME_DATA AC_WALK_D_8F,2
	_ANIME_DATA AC_JUMP_D_2G_16F,1
	_ANIME_DATA AC_WALK_D_16F,1			//<下に移動　16フレーム
	_ANIME_DATA ACMD_END,0

/**************************************************************/
/*  R02 ママのイベントスクリプト*/
/**************************************************************/
EVENT_START   ev_pos_r02_mama_01
	
	//BGMの再生
	_START_EVENT_BGM(SEQ_BGM_E_TSURETEKE1 )
	_FLAG_RESET  ( FV_R02_MOTHER  )
	
    DEFINE_LOCAL  LWK_PLAYER_POSX   
    DEFINE_LOCAL  LWK_PLAYER_POSZ
       
//------------------------------------------------------------//
    _PLAYER_POS_GET( LWK_PLAYER_POSX  ,LWK_PLAYER_POSZ ) //自機座標取得
    
    SWITCH $LWK_PLAYER_POSZ
    CASE 647 THEN
		_OBJ_POS_CHANGE( R02_MAMA_01, 763, 0, 647, DIR_LEFT )
    CASE 648 THEN
        _OBJ_POS_CHANGE( R02_MAMA_01, 763, 0, 648, DIR_LEFT )
    CASE 649 THEN
        _OBJ_POS_CHANGE( R02_MAMA_01, 763, 0, 649, DIR_LEFT )
    CASE 650THEN
        _OBJ_POS_CHANGE( R02_MAMA_01, 763, 0, 649, DIR_LEFT )
    DEFAULT  
    ENDSWITCH
	
	//プレイヤーの名前を取得
	_PLAYER_NAME(0)
	
	//ママが主人公を呼ぶ
	_BALLOONWIN_OBJMSG( msg_r02_mama_01, R02_MAMA_01)
	_BALLOONWIN_CLOSE()

	//主人公、ママの声に気づく
	_OBJ_ANIME( MMDL_ID_PLAYER,anm_player_bikkuri_mark)
	_OBJ_ANIME_WAIT()
	
	//主人公、ママの方へ振り向く
	_OBJ_ANIME(  MMDL_ID_PLAYER,anm_player_migi_muku)
	_OBJ_ANIME_WAIT()
	
	//ママが主人公の方へ来る
    SWITCH $LWK_PLAYER_POSZ
    CASE 650THEN
  		_OBJ_ANIME( R02_MAMA_01,anm_mama_kuru_b)
		_OBJ_ANIME_WAIT()
    DEFAULT  
 		_OBJ_ANIME( R02_MAMA_01,anm_mama_kuru_a)
		_OBJ_ANIME_WAIT()
    ENDSWITCH
	
	//プレイヤーの名前の格納
	_PLAYER_NAME(0)
	
	//ママ「やっと　おいついた」
	_BALLOONWIN_OBJMSG( msg_r02_mama_02, R02_MAMA_01)
	_BALLOONWIN_CLOSE()
	
	//キーアイテムを入手ME
	_ME_PLAY( SEQ_ME_KEYITEM )
//【仮】ランニングシューズ入手イベントは、現在メッセージのみ。
	_SYSWIN_MSG_ALLPUT_DOWN( msg_r02_mama_03 )
	_SYSWIN_CLOSE()
	_ME_WAIT()
	
	//ママがランニングシューズの説明
	_BALLOONWIN_OBJMSG( msg_r02_mama_04, R02_MAMA_01)
	_BALLOONWIN_CLOSE()
	
	_TIME_WAIT( 16 )
	
	//ママ「あなたは　ひとりじゃ〜」
	_BALLOONWIN_OBJMSG( msg_r02_mama_05, R02_MAMA_01)
	_BALLOONWIN_CLOSE()
	
	//ママが帰っていく
	//ママが主人公の方へ来る
    SWITCH $LWK_PLAYER_POSZ
    CASE 650THEN
  		_OBJ_ANIME( R02_MAMA_01,anm_mama_saru_b)
		_OBJ_ANIME_WAIT()
    DEFAULT  
		_OBJ_ANIME( R02_MAMA_01,anm_mama_saru_a)
		_OBJ_ANIME_WAIT()
    ENDSWITCH
	
	//ママ：画面から消す
	_OBJ_DEL( R02_MAMA_01  )
	
	//BGMの終了
	_END_EVENT_BGM()
	
	//==============フラグワーク操作==============//
	
	//R02のママを表示されなくする
	_FLAG_SET  ( FV_R02_MOTHER  )  
	
	//R02のランニングシューズイベントを無効にする
	$WK_SCENE_R02 = 1
	
	//============================================//
	
EVENT_END

//--------------------------------------------------------------------
//ママ:主人公に接近                         
//--------------------------------------------------------------------
_ANIME_LABEL	anm_mama_kuru_a
	_ANIME_DATA AC_WALK_L_8F,7
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ママ:主人公に接近                         
//--------------------------------------------------------------------
_ANIME_LABEL	anm_mama_kuru_b
	_ANIME_DATA AC_WALK_L_8F,6
	_ANIME_DATA AC_WALK_D_8F,1
	_ANIME_DATA AC_WALK_L_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ママ:2番道路から去るA                        
//--------------------------------------------------------------------
_ANIME_LABEL	anm_mama_saru_a
	_ANIME_DATA AC_WALK_R_8F,7
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//ママ:2番道路から去るB                         
//--------------------------------------------------------------------
_ANIME_LABEL	anm_mama_saru_b
	_ANIME_DATA AC_WALK_U_8F,1
	_ANIME_DATA AC_WALK_R_8F,7
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//主人公:びっくりマークを出す                       
//--------------------------------------------------------------------
_ANIME_LABEL	anm_player_bikkuri_mark
	_ANIME_DATA	AC_MARK_GYOE,1
	_ANIME_DATA	ACMD_END,0
	
//--------------------------------------------------------------------
//主人公:右を向く                              
//--------------------------------------------------------------------
_ANIME_LABEL	anm_player_migi_muku
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	ACMD_END,0	

	
/**************************************************************/
/*  R02 BOY2の会話イベントスクリプト*/
/**************************************************************/
EVENT_START   ev_r02_boy2_01

	_EASY_BALLOONWIN_TALKOBJ_MSG(msg_r02_boy2_01) 
	
EVENT_END

/**************************************************************/
/*  R02 GIRL2の会話のイベントスクリプト*/
/**************************************************************/
EVENT_START   ev_r02_girl2_01

	_EASY_BALLOONWIN_TALKOBJ_MSG(msg_r02_girl2_01) 

EVENT_END

/**************************************************************/
/*  R02 GIRL2の会話のイベントスクリプト*/
/**************************************************************/
EVENT_START  ev_r02_mama_01

	_EASY_BALLOONWIN_TALKOBJ_MSG(msg_r02_mama_01) 

EVENT_END



/**************************************************************/
/*  R02 看板1のイベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_r02_board1_01

	_EASY_BGWIN_MSG(msg_r02_sign1_01, TYPE_ROAD) //看板1:2番道路

EVENT_END

/**************************************************************/
/*  R02 看板2のイベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_r02_board2_01

	_EASY_BGWIN_MSG(msg_r02_sign2_01, TYPE_ROAD) //看板2:2番道路

EVENT_END

/**************************************************************/
/*  R02 看板3のイベントスクリプト*/
/**************************************************************/
EVENT_START   ev_bg_r02_board3_01

	_EASY_BGWIN_MSG(msg_r02_sign3_01, TYPE_INFO) //看板3:お得な掲示板

EVENT_END



