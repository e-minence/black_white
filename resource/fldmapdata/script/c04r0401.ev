
//======================================================================
//                c04r0401.ev
//
//    スクリプトファイル：c04r0401用
//
//======================================================================

  .text

  .include  "scr_seq_def.h"
  .include  "../../message/dst/script/msg_c04r0401.h"
  //.include  "c04r0401.h"

//--------------------------------------------------------------
//               スクリプト本体
//--------------------------------------------------------------

//--------------------------------------------------------------
//               スクリプトテーブル
//--------------------------------------------------------------
_EVENT_DATA    ev_c04r0401_badman_01
_EVENT_DATA    ev_c04r0401_woman2_01
_EVENT_DATA    ev_c04r0401_sunglasses_01
_EVENT_DATA    ev_c04r0401_fighterw_01
_EVENT_DATA    ev_zone_c04r0401
_EVENT_DATA    ev_pos_c04r0401_connect_01	//競技場への接続POSイベント
_EVENT_DATA    ev_c04r0401_guardman_01
_EVENT_DATA    ev_c04r0401_guardman_02
_EVENT_DATA    ev_c04r0401_guardman_03
_EVENT_DATA_END


//------------------------！注意！------------------------------//
//																//
//		LOCALWORK15を競技場への接続POSイベントに使用			//
//		ゾーン内での使用を禁止します							//
//																//
//--------------------------------------------------------------//


/************************************************************/
/*					ZONE_CHANGE_SCRIPT						*/
/************************************************************/
INIT_EVENT_START	ev_zone_c04r0401

	//C04側から入った時だけ、開催競技をチェックする
	IF $WK_OTHER_SPORTS_EVENT == SPORTS_EVENT_NONE THEN
		//C04側から入った＝開催競技に何も入っていない
		_CALL	ev_sports_event_chk
	ENDIF

INIT_EVENT_END


//開催競技チェック処理
ev_sports_event_chk:
	//競技の種目を WK_OTHER_SPORTS_EVENT に格納
	//競技中かを FE_SPORTS_PLAYING に格納 1 = 競技中（フィールドに降りれない）

	//曜日を取得
	_GET_WEEK( SCWK_ANSWER )
	SWITCH $SCWK_ANSWER
	CASE RTC_WEEK_TUESDAY, RTC_WEEK_THURSDAY, RTC_WEEK_SATURDAY THEN
	//火曜、木曜、土曜なら「バスケ」

		$WK_OTHER_SPORTS_EVENT = SPORTS_EVENT_BASKETBALL
		
		//競技中かチェック
		_GET_TIME( SCWK_TEMP0, SCWK_TEMP1 )
		IF $SCWK_TEMP0 >= 10 && $SCWK_TEMP0 <= 11 THEN
			//10時〜11時なら競技中
			_FLAG_SET( FE_SPORTS_PLAYING )
		ENDIF

	DEFAULT
	//それ以外（月、水、金、日）なら「テニス」

		$WK_OTHER_SPORTS_EVENT = SPORTS_EVENT_TENNIS
		
		//競技中かチェック
		_GET_TIME( SCWK_TEMP0, SCWK_TEMP1 )
		IF $SCWK_TEMP0 == 10 THEN
			//10時なら競技中
			_FLAG_SET( FE_SPORTS_PLAYING )
		ENDIF

	ENDSWITCH


	//競技中ならワープポイントを塞ぐガードマンを表示
	_FLAG_SET( FV_STADIUM_GUARDMAN )
	IF FLAG_ON( FE_SPORTS_PLAYING ) THEN
		_FLAG_RESET( FV_STADIUM_GUARDMAN )
	ENDIF

_RET


/************************************************************/
/*						ワープポイント						*/
/************************************************************/
//競技場への接続POSイベント
EVENT_START	ev_pos_c04r0401_connect_01
	//競技によってマップ遷移するゾーンを分岐

	//バスケなら
	IF $WK_OTHER_SPORTS_EVENT == SPORTS_EVENT_BASKETBALL THEN
		_MAP_CHANGE_WARP( ZONE_ID_C04R0404, 6, 25, DIR_UP )

	//テニスなら
	ELSE
		_MAP_CHANGE_WARP( ZONE_ID_C04R0403, 6, 25, DIR_UP )

	ENDIF

EVENT_END

/************************************************************/
/*						警備員１〜３						*/
/************************************************************/
EVENT_START	ev_c04r0401_guardman_01

EVENT_END

EVENT_START	ev_c04r0401_guardman_02

EVENT_END

EVENT_START	ev_c04r0401_guardman_03

EVENT_END


/************************************************************/
/*						不良くん							*/
/************************************************************/
EVENT_START	ev_c04r0401_badman_01
	_EASY_BALLOONWIN_TALKOBJ_MSG( msg_c04r0401_badman_01 )
EVENT_END

/************************************************************/
/*						女性２								*/
/************************************************************/
EVENT_START	ev_c04r0401_woman2_01
	_EASY_BALLOONWIN_TALKOBJ_MSG( msg_c04r0401_woman2_01 )
EVENT_END

/************************************************************/
/*						サングラス							*/
/************************************************************/
EVENT_START	ev_c04r0401_sunglasses_01
	_EASY_BALLOONWIN_TALKOBJ_MSG( msg_c04r0401_sunglasses_01 )
EVENT_END

/************************************************************/
/*						格闘家　女性						*/
/************************************************************/
EVENT_START	ev_c04r0401_fighterw_01
	_EASY_BALLOONWIN_TALKOBJ_MSG( msg_c04r0401_fighterw_01 )
EVENT_END


