//======================================================================
//                t01r0401
//======================================================================

  .text

  .include  "scr_seq_def.h"
  .include  "../../../prog/include/msg/script/msg_t01r0401.h"
  .include  "t01r0401.h"

//--------------------------------------------------------------
//               スクリプト本体
//--------------------------------------------------------------

//--------------------------------------------------------------
//               スクリプトテーブル
//--------------------------------------------------------------
_EVENT_DATA		ev_t01r0401_scene_change_01		//図鑑入手イベント
_EVENT_DATA		ev_t01r0401_hakase2_01
_EVENT_DATA_END

/**************************************************************/
/*            FLAG_CHANGE_LABEL                               */
/*
 * 注意！(06.02.09現在)
 * EV_SCRIPT_WORKを確保していないので、
 * SCWK_ANSWERなどのワークは使用することが出来ない！
 * LOCALWORK0などを使用するようにする！
 *
 * 共通スクリプトについては現状使用不可！
 * 対応予定だが、ゾーンをまたいだ時に処理落ちするかも？
 * あまりつかわないかも？
 */
/**************************************************************/


/************************************************************/
/*					SCENE_CHANGE_LABEL						*/
/************************************************************/
EVENT_START   ev_t01r0401_scene_change_01
	//ポケモン図鑑入手イベント

	//３人：博士の前に並ぶ
	_OBJ_ANIME( MMDL_ID_PLAYER,anm_player_walk_01 )
	_OBJ_ANIME( T01R0401_RIVAL_01,anm_friends_walk_01 )
	_OBJ_ANIME( T01R0401_SUPPORT_01,anm_friends_walk_01 )
	_OBJ_ANIME_WAIT()

	//おーきたきた！
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_01,T01R0401_HAKASE2_01 )
	_BALLOONWIN_CLOSE()

	//アララギ博士？どうしたんですか？
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_black_02,T01R0401_RIVAL_01 ) //ライバル
	_BALLOONWIN_CLOSE()

	//まあまあ！今日は記念となる日だからね
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_02,T01R0401_HAKASE2_01 ) //博士
	_BALLOONWIN_CLOSE()

	 //博士：皆の顔を見る
	_OBJ_ANIME( T01R0401_HAKASE2_01,anm_zukan_doc_look_01 )
	_OBJ_ANIME_WAIT()

	//【仮】ニックネーム処理が未実装



	//ポケモンを進呈した理由だが…
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_07,T01R0401_HAKASE2_01 )  //博士
	_BALLOONWIN_CLOSE()

	//ポケモン図鑑ですよね！
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_black_03,T01R0401_RIVAL_01 )  //ライバル
	_BALLOONWIN_CLOSE()

	//ずかん？
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_white_02,T01R0401_SUPPORT_01 ) //サポート
	_BALLOONWIN_CLOSE()

	//さすがだね！
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_08,T01R0401_HAKASE2_01 )  //博士
	_BALLOONWIN_CLOSE()

	//【仮】演出予定：その場で一回転など

	//ポケモン図鑑とは！
	_PLAYER_NAME( 0 ) //プレイヤー名を反映
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_09,T01R0401_HAKASE2_01 )  //博士
	_BALLOONWIN_CLOSE()

	//冒険の旅に出かけるかい？
	_PLAYER_NAME( 0 ) //プレイヤー名を反映
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_10,T01R0401_HAKASE2_01 )  //博士

	_YES_NO_WIN( SCWK_ANSWER )
	_BALLOONWIN_CLOSE()

	_IFVAL_JUMP SCWK_ANSWER,EQ,0,t01r0401_hakase2_yes
	_IFVAL_JUMP SCWK_ANSWER,EQ,1,t01r0401_hakase2_no

t01r0401_hakase2_no:
	//そんな返事は聞きたくない！
	_PLAYER_NAME( 0 ) //プレイヤー名を反映
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_11,T01R0401_HAKASE2_01 ) 
	_AB_KEYWAIT()

	_YES_NO_WIN( SCWK_ANSWER )
	_BALLOONWIN_CLOSE()

	//「はい」を選択するまで同じ質問を繰り返す
	_IFVAL_JUMP SCWK_ANSWER,EQ,0,t01r0401_hakase2_yes
	_IFVAL_JUMP SCWK_ANSWER,EQ,1,t01r0401_hakase2_no

t01r0401_hakase2_yes:
	//よし！最高の返事だ！
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_12,T01R0401_HAKASE2_01 ) 
	_BALLOONWIN_CLOSE()

//********************ポケモン図鑑入手処理*******************//
	//ポケモン図鑑入手フラグをセット
	_FLAG_SET( SYS_FLAG_ZUKAN_GET )

	//ポケモンずかんを手に入れた！
	_PLAYER_NAME( 0 ) //プレイヤー名を反映
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_13,T01R0401_HAKASE2_01 ) 

	//ME鳴らす
	_ME_PLAY( SEQ_ME_KEYITEM )
	_ME_WAIT()

	//【保留】ここに▼なしウェイトいれる？
	_AB_KEYWAIT()
	_BALLOONWIN_CLOSE()

//***********************************************************//

	//１番道路に来てくれよな！
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_hakase2_14,T01R0401_HAKASE2_01 ) 	//博士
	_BALLOONWIN_CLOSE()

	//博士：退室へ（主人公＆ライバル道を開ける）
	_OBJ_ANIME( T01R0401_SUPPORT_01,anm_zukan_player_move_01 )
	_OBJ_ANIME( MMDL_ID_PLAYER,anm_zukan_player_move_01 )
	_OBJ_ANIME( T01R0401_HAKASE2_01,anm_zukan_doc_goaway_01 )
	_OBJ_ANIME_WAIT()

	//博士：退室
	_OBJ_ANIME( T01R0401_HAKASE2_01,anm_zukan_doc_goaway_02 )
	//友達ズ：見送る
	_OBJ_ANIME( T01R0401_RIVAL_01,anm_zukan_friends_look_01 )
	_OBJ_ANIME( MMDL_ID_PLAYER,anm_zukan_friends_look_01 )
	_OBJ_ANIME( T01R0401_SUPPORT_01,anm_zukan_friends_look_01 )
	_OBJ_ANIME_WAIT()

	//博士：消す
	_OBJ_DEL( T01R0401_HAKASE2_01 )

	//頼まれたから　冒険しても　いいんだよね？
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_white_03,T01R0401_SUPPORT_01 )  //サポート
	_BALLOONWIN_CLOSE()

	//僕たちも１番道路に行こう！
	_BALLOONWIN_OBJMSG_OPEN( msg_t01r0401_black_04,T01R0401_RIVAL_01 )  //ライバル
	_BALLOONWIN_CLOSE()

	//サポート＆ライバル：退室
	_OBJ_ANIME( T01R0401_RIVAL_01,anm_zukan_rival_goaway_01 )
	_OBJ_ANIME( T01R0401_SUPPORT_01,anm_zukan_support_goaway_01 )
	_OBJ_ANIME_WAIT()

	//サポート＆ライバル：消す
	_OBJ_DEL( T01R0401_RIVAL_01 )
	_OBJ_DEL( T01R0401_SUPPORT_01 )

//=====================フラグ操作========================//

	//博士、サポート、ライバルのバニッシュフラグをセット
	_FLAG_SET( FV_T01R0401_HAKASE )
	_FLAG_SET( FV_T01R0401_RIVAL )
	_FLAG_SET( FV_T01R0401_SUPPORT )

	//図鑑入手イベント終わった
	$WK_SCENE_T01R0401 = 1

	//T01のR01側ストッパー解除
	$WK_SCENE_T01 = 1

//=======================================================//

EVENT_END


//--------------------------------------------------------------------
//３人：博士の手前まで移動
//--------------------------------------------------------------------
_ANIME_LABEL	anm_player_walk_01
	_ANIME_DATA	AC_WALK_U_8F,5
	_ANIME_DATA	ACMD_END,0

//友達２人のアニメ
_ANIME_LABEL	anm_friends_walk_01
	_ANIME_DATA	AC_WALK_U_8F,2
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//博士：皆の顔を見る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_doc_look_01
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	AC_WAIT_8F,2
	_ANIME_DATA	AC_WALK_R_8F,2
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	AC_WAIT_8F,2
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	AC_WAIT_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//博士：室外へ（まず一歩下に）
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_doc_goaway_01
	_ANIME_DATA	AC_WALK_D_8F,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//主人公＆サポート：道を開ける
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_player_move_01
	_ANIME_DATA	AC_DIR_R,1
	_ANIME_DATA	AC_DIR_PAUSE_ON,1
	_ANIME_DATA	AC_WALK_L_8F,1
	_ANIME_DATA	AC_DIR_PAUSE_OFF,1
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//博士：退室
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_doc_goaway_02
	_ANIME_DATA	AC_WALK_D_8F,7
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//友達ズ：見送る
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_friends_look_01
	_ANIME_DATA	AC_DIR_D,1
	_ANIME_DATA	ACMD_END,0


//--------------------------------------------------------------------
//ライバル：退室
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_rival_goaway_01
	_ANIME_DATA	AC_WALK_D_8F,3
	_ANIME_DATA	AC_WALK_L_8F,2
	_ANIME_DATA	AC_WALK_D_8F,4
	_ANIME_DATA	ACMD_END,0

//--------------------------------------------------------------------
//サポート：退室
//--------------------------------------------------------------------
_ANIME_LABEL	anm_zukan_support_goaway_01
	_ANIME_DATA	AC_WALK_D_8F,3
	_ANIME_DATA	AC_WAIT_8F,2
	_ANIME_DATA	AC_WALK_R_8F,1
	_ANIME_DATA	AC_WALK_D_8F,4
	_ANIME_DATA	ACMD_END,0


/************************************************************/
/*						アララギ博士						*/
/************************************************************/
EVENT_START   ev_t01r0401_hakase2_01

EVENT_END






