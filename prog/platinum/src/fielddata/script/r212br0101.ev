//====================================================================
//							r212br0101
//						かけら＜−＞ワザマシン交換
//====================================================================

	.text

	.include	"scr_seq_def.h"
	.include	"../../../include/msgdata/msg_r212br0101.h"
	//.include	"../eventdata/zone_r212br0101evc.h"

//--------------------------------------------------------------------
//					     スクリプト本体
//--------------------------------------------------------------------

//--------------------------------------------------------------------
//					     スクリプトテーブル
//--------------------------------------------------------------------
_EVENT_DATA		ev_r212br0101_flag_change
_EVENT_DATA		ev_r212br0101_girl1
_EVENT_DATA		ev_r212br0101_woman2
_EVENT_DATA		ev_r212br0101_poster
_EVENT_DATA		ev_r212br0101_waza
_EVENT_DATA_END


/********************************************************************/
/*						FLAG_CHANGE_LABEL 							*/
/********************************************************************/
ev_r212br0101_flag_change:
	_ARRIVE_FLAG_SET		FLAG_ARRIVE_R212BR0101	//到着
	_END


/********************************************************************/
/*																	*/
/********************************************************************/
ev_r212br0101_girl1:
	_JUMP			ev_r212br0101_waza
	_END

	_EASY_OBJ_MSG	msg_r212br0101_girl1_01
	_END


/********************************************************************/
/*																	*/
/********************************************************************/
#define MSG_AKA		(msg_kakera_01)
#define MSG_AO		(msg_kakera_02)
#define MSG_KI		(msg_kakera_03)
#define MSG_MI		(msg_kakera_04)
#define MSG_YAMERU	(msg_ev_win_049)

ev_r212br0101_woman2:
	_TALK_OBJ_START

	/*かけらをもっているかチェック*/
	_CALL			r212br0101_kakera_chk

	/*かけらをもっていない*/
	_IFVAL_JUMP		SCWK_PARAM0,EQ,0,ev_r212br0101_kakera_nothing

	/*かけらをもっている*/
	_TALKMSG		msg_r212br0101_woman2_02

	_SWITCH			SCWK_PARAM0
	_CASE_JUMP		1,r212br0101_aka
	_CASE_JUMP		2,r212br0101_ao
	_CASE_JUMP		4,r212br0101_ki
	_CASE_JUMP		8,r212br0101_mi

	_CASE_JUMP		3,r212br0101_aka_ao
	_CASE_JUMP		5,r212br0101_aka_ki
	_CASE_JUMP		9,r212br0101_aka_mi

	_CASE_JUMP		6,r212br0101_ao_ki
	_CASE_JUMP		10,r212br0101_ao_mi

	_CASE_JUMP		12,r212br0101_ki_mi

	_CASE_JUMP		7,r212br0101_aka_ao_ki
	_CASE_JUMP		11,r212br0101_aka_ao_mi
	_CASE_JUMP		14,r212br0101_ao_ki_mi

	//_CASE_JUMP	15,r212br0101_aka_ao_ki_mi
	_JUMP			r212br0101_aka_ao_ki_mi
	_END

//--------------------------------------------------------------------
/*メニュー*/
//--------------------------------------------------------------------
/*赤*/
r212br0101_aka:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_YAMERU,1
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_JUMP			ev_r212br0101_yameru
	_END

/*青*/
r212br0101_ao:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AO,0
	_BMPMENU_MAKE_LIST	MSG_YAMERU,1
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_ao
	_JUMP			ev_r212br0101_yameru
	_END

/*黄*/
r212br0101_ki:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_KI,0
	_BMPMENU_MAKE_LIST	MSG_YAMERU,1
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_ki
	_JUMP			ev_r212br0101_yameru
	_END

/*緑*/
r212br0101_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_MI,0
	_BMPMENU_MAKE_LIST	MSG_YAMERU,1
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

/*赤、青*/
r212br0101_aka_ao:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_AO,1
	_BMPMENU_MAKE_LIST	MSG_YAMERU,2
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_CASE_JUMP		1,ev_r212br0101_ao
	_JUMP			ev_r212br0101_yameru
	_END

/*赤、黄*/
r212br0101_aka_ki:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_KI,1
	_BMPMENU_MAKE_LIST	MSG_YAMERU,2
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_CASE_JUMP		1,ev_r212br0101_ki
	_JUMP			ev_r212br0101_yameru
	_END

/*赤、緑*/
r212br0101_aka_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_MI,1
	_BMPMENU_MAKE_LIST	MSG_YAMERU,2
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_CASE_JUMP		1,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

/*青、黄*/
r212br0101_ao_ki:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AO,0
	_BMPMENU_MAKE_LIST	MSG_KI,1
	_BMPMENU_MAKE_LIST	MSG_YAMERU,2
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_ao
	_CASE_JUMP		1,ev_r212br0101_ki
	_JUMP			ev_r212br0101_yameru
	_END

/*青、緑*/
r212br0101_ao_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AO,0
	_BMPMENU_MAKE_LIST	MSG_MI,1
	_BMPMENU_MAKE_LIST	MSG_YAMERU,2
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_ao
	_CASE_JUMP		1,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

/*黄、緑*/
r212br0101_ki_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_KI,0
	_BMPMENU_MAKE_LIST	MSG_MI,1
	_BMPMENU_MAKE_LIST	MSG_YAMERU,2
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_ki
	_CASE_JUMP		1,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

/*赤、青、黄*/
r212br0101_aka_ao_ki:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_AO,1
	_BMPMENU_MAKE_LIST	MSG_KI,2
	_BMPMENU_MAKE_LIST	MSG_YAMERU,3
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_CASE_JUMP		1,ev_r212br0101_ao
	_CASE_JUMP		2,ev_r212br0101_ki
	_JUMP			ev_r212br0101_yameru
	_END

/*赤、青、緑*/
r212br0101_aka_ao_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_AO,1
	_BMPMENU_MAKE_LIST	MSG_MI,2
	_BMPMENU_MAKE_LIST	MSG_YAMERU,3
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_CASE_JUMP		1,ev_r212br0101_ao
	_CASE_JUMP		2,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

/*青、黄、緑*/
r212br0101_ao_ki_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AO,0
	_BMPMENU_MAKE_LIST	MSG_KI,1
	_BMPMENU_MAKE_LIST	MSG_MI,2
	_BMPMENU_MAKE_LIST	MSG_YAMERU,3
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_ao
	_CASE_JUMP		1,ev_r212br0101_ki
	_CASE_JUMP		2,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

/*赤、青、黄、緑*/
r212br0101_aka_ao_ki_mi:
	_BMPMENU_INIT		1,1,0,1,SCWK_ANSWER		//Bキャンセル有効
	_BMPMENU_MAKE_LIST	MSG_AKA,0
	_BMPMENU_MAKE_LIST	MSG_AO,1
	_BMPMENU_MAKE_LIST	MSG_KI,2
	_BMPMENU_MAKE_LIST	MSG_MI,3
	_BMPMENU_MAKE_LIST	MSG_YAMERU,4
	_BMPMENU_START

	_SWITCH			SCWK_ANSWER
	_CASE_JUMP		0,ev_r212br0101_aka
	_CASE_JUMP		1,ev_r212br0101_ao
	_CASE_JUMP		2,ev_r212br0101_ki
	_CASE_JUMP		3,ev_r212br0101_mi
	_JUMP			ev_r212br0101_yameru
	_END

//--------------------------------------------------------------------
/*交換情報セット*/
//--------------------------------------------------------------------
/*赤いかけらと交換*/
ev_r212br0101_aka:
	_ITEM_NAME		0,ITEM_WAZAMASIN11
	_ITEM_WAZA_NAME		1,ITEM_WAZAMASIN11
	_LDVAL			SCWK_TEMP0,ITEM_WAZAMASIN11
	_LDVAL			SCWK_TEMP2,ITEM_AKAIKAKERA
	_TALK_KEYWAIT	msg_r212br0101_woman2_03
	_JUMP			common_r212br0101_woman2_01

/*青いかけらと交換*/
ev_r212br0101_ao:
	_ITEM_NAME		0,ITEM_WAZAMASIN18
	_ITEM_WAZA_NAME		1,ITEM_WAZAMASIN18
	_LDVAL			SCWK_TEMP0,ITEM_WAZAMASIN18
	_LDVAL			SCWK_TEMP2,ITEM_AOIKAKERA
	_TALK_KEYWAIT	msg_r212br0101_woman2_04
	_JUMP			common_r212br0101_woman2_01

/*黄いかけらと交換*/
ev_r212br0101_ki:
	_ITEM_NAME		0,ITEM_WAZAMASIN37
	_ITEM_WAZA_NAME		1,ITEM_WAZAMASIN37
	_LDVAL			SCWK_TEMP0,ITEM_WAZAMASIN37
	_LDVAL			SCWK_TEMP2,ITEM_KIIROIKAKERA
	_TALK_KEYWAIT	msg_r212b0101_woman2_05
	_JUMP			common_r212br0101_woman2_01

/*緑のかけらと交換*/
ev_r212br0101_mi:
	_ITEM_NAME		0,ITEM_WAZAMASIN07
	_ITEM_WAZA_NAME		1,ITEM_WAZAMASIN07
	_LDVAL			SCWK_TEMP0,ITEM_WAZAMASIN07
	_LDVAL			SCWK_TEMP2,ITEM_MIDORINOKAKERA
	_TALK_KEYWAIT	msg_r212br0101_woman2_06
	_JUMP			common_r212br0101_woman2_01

/*やめる*/
ev_r212br0101_yameru:
	_TALKMSG		msg_r212br0101_woman2_07
	_LAST_KEYWAIT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END

/*技マシン入手共通処理*/
common_r212br0101_woman2_01:
	//アイテム名、個数をセット
	_LDVAL			SCWK_TEMP1,1

	//アイテム取得出来るかチェック
	_ADD_ITEM_CHK	SCWK_TEMP0,SCWK_TEMP1,SCWK_ANSWER
	_IFVAL_JUMP		SCWK_ANSWER,EQ,0,ev_r212br0101_woman2_item_event_fail

	/*かけらを減らす*/
	_SUB_ITEM		SCWK_TEMP2,10,SCWK_ANSWER

	//アイテム取得成功イベント(SCWK_TEMP0=アイテムナンバー、SCWK_TEMP1=個数を代入しておく)
	_CHG_COMMON_SCR	SCRID_ITEM_EVENT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END

/*アイテム入手失敗*/
ev_r212br0101_woman2_item_event_fail:
	_TALKMSG		msg_r212br0101_woman2_08
	_LAST_KEYWAIT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END

//--------------------------------------------------------------------
/*かけらをもっているかチェック*/
//--------------------------------------------------------------------
r212br0101_kakera_chk:
	_LDVAL		SCWK_PARAM0,0

	/*赤10個もっているか？*/
	_ITEM_CHK	ITEM_AKAIKAKERA,10,SCWK_ANSWER
	_IFVAL_CALL	SCWK_ANSWER,EQ,TRUE,ev_r212br0101_true_aka
	
	/*青10個もっているか？*/
	_ITEM_CHK	ITEM_AOIKAKERA,10,SCWK_ANSWER
	_IFVAL_CALL	SCWK_ANSWER,EQ,TRUE,ev_r212br0101_true_ao

	/*黄10個もっているか？*/
	_ITEM_CHK	ITEM_KIIROIKAKERA,10,SCWK_ANSWER
	_IFVAL_CALL	SCWK_ANSWER,EQ,TRUE,ev_r212br0101_true_ki

	/*緑10個もっているか？*/
	_ITEM_CHK	ITEM_MIDORINOKAKERA,10,SCWK_ANSWER
	_IFVAL_CALL	SCWK_ANSWER,EQ,TRUE,ev_r212br0101_true_mi

	_RET

ev_r212br0101_true_aka:
	_ADD_WK		SCWK_PARAM0,1
	_RET

ev_r212br0101_true_ao:
	_ADD_WK		SCWK_PARAM0,2
	_RET

ev_r212br0101_true_ki:
	_ADD_WK		SCWK_PARAM0,4
	_RET

ev_r212br0101_true_mi:
	_ADD_WK		SCWK_PARAM0,8
	_RET

//--------------------------------------------------------------------
/*かけらをもっていない*/
//--------------------------------------------------------------------
ev_r212br0101_kakera_nothing:
	_TALKMSG		msg_r212br0101_woman2_01
	_LAST_KEYWAIT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END

/********************************************************************/
/*							ポスター								*/
/********************************************************************/
ev_r212br0101_poster:
	_EASY_MSG		msg_r212br0101_poster_01
	_END


/********************************************************************/
/*							技教えオヤジ							*/
/********************************************************************/
ev_r212br0101_waza:
	_TALK_OBJ_START

	/*「技を教えて欲しいですか？」*/
	_TALKMSG		msg_r212br0101_waza_01
	_YES_NO_WIN		SCWK_ANSWER
	_IFVAL_JUMP		SCWK_ANSWER,EQ,0,yes_r212br0101_01
	_IFVAL_JUMP		SCWK_ANSWER,EQ,1,no_r212br0101_01
	_END

/*「はい」*/
yes_r212br0101_01:
	/*「どのポケモンにしますか？」*/
	_TALKMSG		msg_r212br0101_waza_03
	_TALK_CLOSE

	_BLACK_OUT		SCR_WIPE_DIV,SCR_WIPE_SYNC
	_WIPE_FADE_END_CHECK

	/*ポケモン選択画面*/
	_POKELIST_SET_PROC
	/*選択したポケモンの並び番号取得*/
	_POKELIST_GET_RESULT	SCWK_PARAM0
	_SET_MAP_PROC

	_BLACK_IN		SCR_WIPE_DIV,SCR_WIPE_SYNC
	_WIPE_FADE_END_CHECK

	_IFVAL_JUMP		SCWK_PARAM0,EQ,0xff,no_r212br0101_01	/*キャンセルされた*/

	/*手持ちー＞ポケモン番号変換　同時にタマゴチェックも行っています*/
	_TEMOTI_MONSNO	SCWK_PARAM0,SCWK_PARAM1
	_IFVAL_JUMP		SCWK_PARAM1,EQ,0,ev_r212br0101_tamago	/*タマゴ*/

	/*覚えられる技があるかチェック*/
	_WAZA_OSHIE_DATA_COUNT	SCWK_PARAM0,SCWK_ANSWER

	/*覚えられる技がない*/
	_IFVAL_JUMP			SCWK_ANSWER,EQ,FALSE,ev_r212br0101_waza_not

	/*「ポケにどの技を覚えさせますか？」*/
	_POKEMON_NAME	0,SCWK_PARAM0
	_TALK_KEYWAIT	msg_r212br0101_waza_06

	/*技習得画面*/
	_WAZA_OSHIE_BMPLIST_START	SCWK_PARAM0,WAZA_OSHIE_COL_BLUE,SCWK_ANSWER
	_LDWK			SCWK_PARAM3,SCWK_ANSWER					/*選択した技ナンバーを取得*/

	/*キャンセルされた*/
	_IFVAL_JUMP		SCWK_PARAM3,EQ,EV_WIN_B_CANCEL,no_r212br0101_01

	/*かけらが不足しているかチェック*/
	_WAZA_OSHIE_ITEM_CHECK	SCWK_PARAM3,SCWK_ANSWER
	_IFVAL_JUMP		SCWK_ANSWER,EQ,0,ev_r212br0101_kakera_not

	/*技数を取得*/
	_WAZA_COUNT		SCWK_ANSWER,SCWK_PARAM0
	_IFVAL_JUMP		SCWK_ANSWER,EQ,4,ev_r212br0101_waza_4
	_JUMP			ev_r212br0101_waza_3
	_END


/********************************************************************/
/*							技の数が4の時							*/
/********************************************************************/
ev_r212br0101_waza_4:
	_POKEMON_NAME	0,SCWK_PARAM0
	_WAZA_NAME		1,SCWK_PARAM3
	_TALKMSG		msg_r212br0101_waza_10
	_YES_NO_WIN		SCWK_ANSWER
	_IFVAL_JUMP		SCWK_ANSWER,EQ,1,no_r212br0101_05

	_BLACK_OUT		SCR_WIPE_DIV,SCR_WIPE_SYNC
	_WIPE_FADE_END_CHECK

	_TALK_CLOSE
	_WAZA_OSHIE_POKESTATUS_SET_PROC		SCWK_PARAM0,SCWK_PARAM3	/*ロトム c04r0205でも使用*/
	_WAZA_OSHIE_POKESTATUS_GET_RESULT	SCWK_PARAM2				/*ロトム c04r0205でも使用*/
	_SET_MAP_PROC

	_BLACK_IN		SCR_WIPE_DIV,SCR_WIPE_SYNC
	_WIPE_FADE_END_CHECK

	_IFVAL_JUMP		SCWK_PARAM2,EQ,4,no_r212br0101_05			/*キャンセル*/

	_JUMP			ev_r212br0101_waza_ok
	_END

/*「いいえ」*/
no_r212br0101_05:
	_POKEMON_NAME	0,SCWK_PARAM0
	_TALKMSG		msg_r212br0101_waza_11
	_YES_NO_WIN		SCWK_ANSWER
	_IFVAL_JUMP		SCWK_ANSWER,EQ,0,no_r212br0101_05_02
	_JUMP			ev_r212br0101_waza_4
	_END

/*「覚えずに終わった」*/
no_r212br0101_05_02:
	_POKEMON_NAME	0,SCWK_PARAM0
	_WAZA_NAME		1,SCWK_PARAM3
	_TALKMSG		msg_r212br0101_waza_12
	_JUMP			no_r212br0101_01
	_END


/********************************************************************/
/*							技の数が3以下の時						*/
/********************************************************************/
ev_r212br0101_waza_3:
	_POKEMON_NAME	0,SCWK_PARAM0
	_WAZA_NAME		1,SCWK_PARAM3
	_TALK_KEYWAIT	msg_r212br0101_waza_09
	_JUMP			ev_r212br0101_waza_ok
	_END


/********************************************************************/
/*							技覚える								*/
/********************************************************************/
ev_r212br0101_waza_ok:
	/*かけら削除*/
	_WAZA_OSHIE_ITEM_SUB	SCWK_PARAM3

	//技セット(手持ち位置、技位置、技ナンバー)
	_WAZA_OSHIE_CHG_POKE_WAZA SCWK_PARAM0,SCWK_PARAM2,SCWK_PARAM3	/*r212br0101 ロトムでも使用*/

	_JUMP			no_r212br0101_01		/*「またどうぞ」*/
	_END


/********************************************************************/
/*							タマゴ									*/
/********************************************************************/
ev_r212br0101_tamago:
	_JUMP			no_r212br0101_01
	_END


/********************************************************************/
/*							いいえ									*/
/********************************************************************/
/*「いいえ」*/
no_r212br0101_01:
	_TALK_KEYWAIT	msg_r212br0101_waza_02
	_LAST_KEYWAIT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END


/********************************************************************/
/*						覚えられる技がない							*/
/********************************************************************/
ev_r212br0101_waza_not:
	_TALK_KEYWAIT	msg_r212br0101_waza_04
	_LAST_KEYWAIT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END


/********************************************************************/
/*						かけらが不足している						*/
/********************************************************************/
ev_r212br0101_kakera_not:
	_TALK_KEYWAIT	msg_r212br0101_waza_05
	_LAST_KEYWAIT
	_TALK_CLOSE
	_TALK_OBJ_END
	_END


